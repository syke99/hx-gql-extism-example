(()=>{"use strict";var t=Object.create,e=Object.defineProperty,s=Object.getOwnPropertyDescriptor,l=Object.getOwnPropertyNames,i=Object.getPrototypeOf,n=Object.prototype.hasOwnProperty,r=(t,e)=>()=>(e||t((e={exports:{}}).exports,e),e.exports),a=(t,s,l)=>(((t,s,l)=>{s in t?e(t,s,{enumerable:!0,configurable:!0,writable:!0,value:l}):t[s]=l})(t,"symbol"!=typeof s?s+"":s,l),l),d=(t,e,s)=>{if(!e.has(t))throw TypeError("Cannot "+s)},h=(t,e,s)=>(d(t,e,"read from private field"),s?s.call(t):e.get(t)),c=(t,e,s)=>{if(e.has(t))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(t):e.set(t,s)},o=(t,e,s,l)=>(d(t,e,"write to private field"),l?l.call(t,s):e.set(t,s),s),u=(t,e,s)=>(d(t,e,"access private method"),s),m=r(((t,e)=>{function s(t,e,s){t instanceof RegExp&&(t=l(t,s)),e instanceof RegExp&&(e=l(e,s));var n=i(t,e,s);return n&&{start:n[0],end:n[1],pre:s.slice(0,n[0]),body:s.slice(n[0]+t.length,n[1]),post:s.slice(n[1]+e.length)}}function l(t,e){var s=e.match(t);return s?s[0]:null}function i(t,e,s){var l,i,n,r,a,d=s.indexOf(t),h=s.indexOf(e,d+1),c=d;if(d>=0&&h>0){if(t===e)return[d,h];for(l=[],n=s.length;c>=0&&!a;)c==d?(l.push(c),d=s.indexOf(t,c+1)):1==l.length?a=[l.pop(),h]:((i=l.pop())<n&&(n=i,r=h),h=s.indexOf(e,c+1)),c=d<h&&d>=0?d:h;l.length&&(a=[n,r])}return a}e.exports=s,s.range=i})),p=r(((t,e)=>{var s=m();e.exports=function(t){return t?("{}"===t.substr(0,2)&&(t="\\{\\}"+t.substr(2)),Z(function(t){return t.split("\\\\").join(l).split("\\{").join(i).split("\\}").join(n).split("\\,").join(r).split("\\.").join(a)}(t),!0).map(h)):[]};var l="\0SLASH"+Math.random()+"\0",i="\0OPEN"+Math.random()+"\0",n="\0CLOSE"+Math.random()+"\0",r="\0COMMA"+Math.random()+"\0",a="\0PERIOD"+Math.random()+"\0";function d(t){return parseInt(t,10)==t?parseInt(t,10):t.charCodeAt(0)}function h(t){return t.split(l).join("\\").split(i).join("{").split(n).join("}").split(r).join(",").split(a).join(".")}function c(t){if(!t)return[""];var e=[],l=s("{","}",t);if(!l)return t.split(",");var i=l.pre,n=l.body,r=l.post,a=i.split(",");a[a.length-1]+="{"+n+"}";var d=c(r);return r.length&&(a[a.length-1]+=d.shift(),a.push.apply(a,d)),e.push.apply(e,a),e}function o(t){return"{"+t+"}"}function u(t){return/^-?0\d/.test(t)}function p(t,e){return t<=e}function b(t,e){return t>=e}function Z(t,e){var l=[],i=s("{","}",t);if(!i)return[t];var r=i.pre,a=i.post.length?Z(i.post,!1):[""];if(/\$$/.test(i.pre))for(var h=0;h<a.length;h++){var m=r+"{"+i.body+"}"+a[h];l.push(m)}else{var f,y,X=/^-?\d+\.\.-?\d+(?:\.\.-?\d+)?$/.test(i.body),G=/^[a-zA-Z]\.\.[a-zA-Z](?:\.\.-?\d+)?$/.test(i.body),V=X||G,W=i.body.indexOf(",")>=0;if(!V&&!W)return i.post.match(/,.*\}/)?Z(t=i.pre+"{"+i.body+n+i.post):[t];if(V)f=i.body.split(/\.\./);else if(1===(f=c(i.body)).length&&1===(f=Z(f[0],!1).map(o)).length)return a.map((function(t){return i.pre+f[0]+t}));if(V){var g=d(f[0]),w=d(f[1]),x=Math.max(f[0].length,f[1].length),R=3==f.length?Math.abs(d(f[2])):1,L=p;w<g&&(R*=-1,L=b);var I=f.some(u);y=[];for(var H=g;L(H,w);H+=R){var z;if(G)"\\"===(z=String.fromCharCode(H))&&(z="");else if(z=String(H),I){var Y=x-z.length;if(Y>0){var S=new Array(Y+1).join("0");z=H<0?"-"+S+z.slice(1):S+z}}y.push(z)}}else{y=[];for(var K=0;K<f.length;K++)y.push.apply(y,Z(f[K],!1))}for(K=0;K<y.length;K++)for(h=0;h<a.length;h++)m=r+y[K]+a[h],(!e||V||m)&&l.push(m)}return l}})),b={allowSharedBufferCodec:!1,manifestSupportsPaths:!1,crossOriginChecksEnforced:!0,fsAccess:!1,hasWorkerCapability:!(typeof globalThis<"u")||globalThis.crossOriginIsolated&&typeof SharedArrayBuffer<"u",supportsWasiPreview1:!0};async function Z(t,e){if("application/octet-stream"===String(t.headers.get("Content-Type")).split(";")[0]){let e=new Headers(t.headers);e.set("Content-Type","application/wasm"),t=new Response(t.body,{status:t.status,statusText:t.statusText,headers:e})}let s=e?await t.clone().arrayBuffer():void 0;return{module:await WebAssembly.compileStreaming(t),data:s}}async function f(t,e){if(t instanceof ArrayBuffer)return{wasm:[{data:new Uint8Array(t)}]};if(t instanceof WebAssembly.Module)return{wasm:[{module:t}]};if("string"==typeof t){if(0===t.search(/^\s*\{/g))return JSON.parse(t);if(0!==t.search(/^(https?|file):\/\//))return{wasm:[{path:t}]};t=new URL(t)}if(t instanceof Response||"Response"===t?.constructor?.name){let s=t,l=s.headers.get("content-type")||"application/octet-stream";switch(l.split(";")[0]){case"application/octet-stream":case"application/wasm":return{wasm:[{response:s}]};case"application/json":case"text/json":return f(JSON.parse(await s.text()),e);default:throw new TypeError(`While processing manifest URL "${s.url}"; expected content-type of "text/json", "application/json", "application/octet-stream", or "application/wasm"; got "${l}" after stripping off charset.`)}}if(t instanceof URL)return f(await e(t,{redirect:"follow"}),e);if(!("wasm"in t))throw new TypeError('Expected "wasm" key in manifest');if(!Array.isArray(t.wasm))throw new TypeError('Expected "manifest.wasm" to be array');let s=t.wasm.findIndex((t=>!("data"in t||"url"in t||"path"in t||"module"in t||"response"in t)));if(s>-1)throw new TypeError(`Expected every item in "manifest.wasm" to include either a "data", "url", or "path" key; got bad item at index ${s}`);return{...t}}async function y(t,e=fetch){let s=await f(t,e);return s.config??={},s}var X,G,V=class extends DataView{constructor(t){super(t),c(this,G,null)}json(){return JSON.parse(this.string())}arrayBuffer(){return this.buffer}text(){return this.string()}string(){return h(V,X).decode(this.buffer)}bytes(){return h(this,G)??o(this,G,new Uint8Array(this.buffer)),h(this,G)}setInt8(t,e){throw new Error("Cannot set values on output")}setInt16(t,e,s){throw new Error("Cannot set values on output")}setInt32(t,e,s){throw new Error("Cannot set values on output")}setUint8(t,e){throw new Error("Cannot set values on output")}setUint16(t,e,s){throw new Error("Cannot set values on output")}setUint32(t,e,s){throw new Error("Cannot set values on output")}setFloat32(t,e,s){throw new Error("Cannot set values on output")}setFloat64(t,e,s){throw new Error("Cannot set values on output")}setBigInt64(t,e,s){throw new Error("Cannot set values on output")}setBigUint64(t,e,s){throw new Error("Cannot set values on output")}},W=V;X=new WeakMap,G=new WeakMap,c(W,X,new TextDecoder);var g=Symbol("begin"),w=Symbol("end"),x=Symbol("env"),R=Symbol("get-block"),L=Symbol("import-state"),I=Symbol("export-state"),H=Symbol("store-value"),z=Symbol("reset"),Y=class{buffer;view;local;get byteLength(){return this.buffer.byteLength}constructor(t,e){this.buffer=t,this.view=new DataView(this.buffer),this.local=e}static indexToAddress(t){return BigInt(t)<<48n}static addressToIndex(t){return Number(BigInt(t)>>48n)}static maskAddress(t){return Number(BigInt(t)&(1n<<48n)-1n)}},S=class{#t;#e=[];#s;#l;#i;#n;#r;#a=new Map;constructor(t,e,s){this.#n=t,this.#s=e,this.#l=new TextDecoder,this.#i=new TextEncoder,this.#t=[],this.alloc(1),this.#r=s}alloc(t){let e=new Y(new this.#n(Number(t)),!0),s=this.#e.length;return this.#e.push(e),Y.indexToAddress(s)}getVariable(t){return this.#a.has(t)?this.read(this.#a.get(t)):null}setVariable(t,e){let s=this[H](e);if(null===s)return 0n;let l=this.#a.get(t)??null;return null!==l&&(this.#e[l]=this.#e[s],this.#e[s]=null,s===this.#e.length-1&&this.#e.pop()),this.#a.set(t,l??s),Y.indexToAddress(l??s)}read(t){let e=Y.addressToIndex(t),s=this.#e[e];if(!s)return null;let l=s.buffer instanceof ArrayBuffer||b.allowSharedBufferCodec?s.buffer:new Uint8Array(s.buffer).slice().buffer;return new W(l)}store(t){let e=this[H](t);if(!e)throw new Error("failed to store output");return Y.indexToAddress(e)}[x]={alloc:t=>this.alloc(t),free:t=>{this.#e[Y.addressToIndex(t)]=null},load_u8:t=>{let e=Y.addressToIndex(t),s=Y.maskAddress(t);return this.#e[e]?.view.getUint8(Number(s))},load_u64:t=>{let e=Y.addressToIndex(t),s=Y.maskAddress(t);return this.#e[e]?.view.getBigUint64(Number(s),!0)},store_u8:(t,e)=>{let s=Y.addressToIndex(t),l=Y.maskAddress(t);this.#e[s]?.view.setUint8(Number(l),Number(e))},store_u64:(t,e)=>{let s=Y.addressToIndex(t),l=Y.maskAddress(t);this.#e[s]?.view.setBigUint64(Number(l),e,!0)},input_length:()=>BigInt(this.#d?.byteLength??0),input_load_u8:t=>{let e=Y.maskAddress(t);return this.#d?.view.getUint8(Number(e))},input_load_u64:t=>{let e=Y.maskAddress(t);return this.#d?.view.getBigUint64(Number(e),!0)},output_set:(t,e)=>{let s=Y.addressToIndex(t),l=this.#e[s];if(!l)throw new Error(`cannot assign to this block (addr=${t.toString(16).padStart(16,"0")}; length=${e})`);if(e>l.buffer.byteLength)throw new Error("length longer than target block");this.#t[this.#t.length-1][1]=s},error_set:t=>{let e=Y.addressToIndex(t);if(!this.#e[e])throw new Error("cannot assign to this block");this.#t[this.#t.length-1][2]=e},config_get:t=>{let e=this.read(t);if(null===e)return 0n;let s=e.string();return s in this.#r?this.store(this.#r[s]):0n},var_get:t=>{let e=this.read(t);if(null===e)return 0n;let s=e.string();return this.#a.has(s)?Y.indexToAddress(this.#a.get(s)):0n},var_set:(t,e)=>{let s=this.read(t);if(null===s)return 0n;let l=s.string();if(0n===e)return this.#a.delete(l),0n;this.#a.set(l,Y.addressToIndex(e))},http_request:(t,e)=>(this.#s.error("http_request is not enabled"),0n),http_status_code:()=>(this.#s.error("http_status_code is not enabled"),0),length:t=>{let e=Y.addressToIndex(t),s=this.#e[e];return s?BigInt(s.buffer.byteLength):0n},log_warn:t=>{let e=Y.addressToIndex(t),s=this.#e[e];if(!s)return this.#s.error(`failed to log(warn): bad block reference in addr 0x${t.toString(16).padStart(64,"0")}`);let l=this.#l.decode(s.buffer);this.#s.warn(l)},log_info:t=>{let e=Y.addressToIndex(t),s=this.#e[e];if(!s)return this.#s.error(`failed to log(info): bad block reference in addr 0x${t.toString(16).padStart(64,"0")}`);let l=this.#l.decode(s.buffer);this.#s.info(l)},log_debug:t=>{let e=Y.addressToIndex(t),s=this.#e[e];if(!s)return this.#s.error(`failed to log(debug): bad block reference in addr 0x${t.toString(16).padStart(64,"0")}`);let l=this.#l.decode(s.buffer);this.#s.debug(l)},log_error:t=>{let e=Y.addressToIndex(t),s=this.#e[e];if(!s)return this.#s.error(`failed to log(error): bad block reference in addr 0x${t.toString(16).padStart(64,"0")}`);let l=this.#l.decode(s.buffer);this.#s.error(l)}};get#d(){let t=this.#t[this.#t.length-1][0];return null===t?null:this.#e[t]}[z](){this.#e.length=1,this.#t.length=0}[R](t){let e=this.#e[t];if(!e)throw new Error(`invalid block index: ${t}`);return e}[L](t,e=!1){for(let[s,l]of t.blocks){if(s&&e){let t=new Uint8Array(new this.#n(Number(s.byteLength)));t.set(new Uint8Array(s)),s=t.buffer}this.#e[l]=s?new Y(s,!1):null}this.#t=t.stack}[I](){return{stack:this.#t.slice(),blocks:this.#e.map(((t,e)=>t?t.local?(t.local=!1,[t.buffer,e]):null:[null,e])).filter(Boolean)}}[H](t){if(!t)return null;if("string"==typeof t&&(t=this.#i.encode(t)),t instanceof Uint8Array){if(t.buffer.constructor===this.#n){let e=this.#e.length;return this.#e.push(new Y(t.buffer,!0)),e}let e=Y.addressToIndex(this.alloc(t.length)),s=this.#e[e];return new Uint8Array(s.buffer).set(t,0),e}return t}[g](t){this.#t.push([t,null,null])}[w](){let[,t,e]=this.#t.pop(),s=null===e?1:0,l=e??t,i=[null,null];return null===l||null===this.#e[l]||(i[s]=l),i}},K=class{static read_bytes(t,e){let s=new K;return s.buf=t.getUint32(e,!0),s.buf_len=t.getUint32(e+4,!0),s}static read_bytes_array(t,e,s){let l=[];for(let i=0;i<s;i++)l.push(K.read_bytes(t,e+8*i));return l}},k=class{static read_bytes(t,e){let s=new k;return s.buf=t.getUint32(e,!0),s.buf_len=t.getUint32(e+4,!0),s}static read_bytes_array(t,e,s){let l=[];for(let i=0;i<s;i++)l.push(k.read_bytes(t,e+8*i));return l}},J=class{write_bytes(t,e){t.setUint8(e,this.fs_filetype),t.setUint16(e+2,this.fs_flags,!0),t.setBigUint64(e+8,this.fs_rights_base,!0),t.setBigUint64(e+16,this.fs_rights_inherited,!0)}constructor(t,e){this.fs_rights_base=0n,this.fs_rights_inherited=0n,this.fs_filetype=t,this.fs_flags=e}},F=class{write_bytes(t,e){t.setBigUint64(e,this.dev,!0),t.setBigUint64(e+8,this.ino,!0),t.setUint8(e+16,this.filetype),t.setBigUint64(e+24,this.nlink,!0),t.setBigUint64(e+32,this.size,!0),t.setBigUint64(e+38,this.atim,!0),t.setBigUint64(e+46,this.mtim,!0),t.setBigUint64(e+52,this.ctim,!0)}constructor(t,e){this.dev=0n,this.ino=0n,this.nlink=0n,this.atim=0n,this.mtim=0n,this.ctim=0n,this.filetype=t,this.size=e}},C=class{start(t){this.inst=t,t.exports._start()}initialize(t){this.inst=t,t.exports._initialize()}constructor(t,e,s){this.args=[],this.env=[],this.fds=[],this.args=t,this.env=e,this.fds=s;let l=this;this.wasiImport={args_sizes_get(t,e){let s=new DataView(l.inst.exports.memory.buffer);s.setUint32(t,l.args.length,!0);let i=0;for(let t of l.args)i+=t.length+1;return s.setUint32(e,i,!0),0},args_get(t,e){let s=new DataView(l.inst.exports.memory.buffer),i=new Uint8Array(l.inst.exports.memory.buffer);for(let n=0;n<l.args.length;n++){s.setUint32(t,e,!0),t+=4;let r=new TextEncoder("utf-8").encode(l.args[n]);i.set(r,e),s.setUint8(e+r.length,0),e+=r.length+1}return 0},environ_sizes_get(t,e){let s=new DataView(l.inst.exports.memory.buffer);s.setUint32(t,l.env.length,!0);let i=0;for(let t of l.env)i+=t.length+1;return s.setUint32(e,i,!0),0},environ_get(t,s){let i=new DataView(l.inst.exports.memory.buffer),n=new Uint8Array(l.inst.exports.memory.buffer);for(let l=0;l<e.length;l++){i.setUint32(t,s,!0),t+=4;let r=new TextEncoder("utf-8").encode(e[l]);n.set(r,s),i.setUint8(s+r.length,0),s+=r.length+1}return 0},clock_res_get(t,e){throw"unimplemented"},clock_time_get(t,e,s){let i=new DataView(l.inst.exports.memory.buffer);if(0===t)i.setBigUint64(s,1000000n*BigInt((new Date).getTime()),!0);else if(1==t){let t;try{t=BigInt(Math.round(1e6*performance.now()))}catch{t=0n}i.setBigUint64(s,t,!0)}else i.setBigUint64(s,0n,!0);return 0},fd_advise:(t,e,s,i)=>null!=l.fds[t]?l.fds[t].fd_advise(e,s,i):8,fd_allocate:(t,e,s)=>null!=l.fds[t]?l.fds[t].fd_allocate(e,s):8,fd_close(t){if(null!=l.fds[t]){let e=l.fds[t].fd_close();return l.fds[t]=void 0,e}return 8},fd_datasync:t=>null!=l.fds[t]?l.fds[t].fd_datasync():8,fd_fdstat_get(t,e){if(null!=l.fds[t]){let{ret:s,fdstat:i}=l.fds[t].fd_fdstat_get();return i?.write_bytes(new DataView(l.inst.exports.memory.buffer),e),s}return 8},fd_fdstat_set_flags:(t,e)=>null!=l.fds[t]?l.fds[t].fd_fdstat_set_flags(e):8,fd_fdstat_set_rights:(t,e,s)=>null!=l.fds[t]?l.fds[t].fd_fdstat_set_rights(e,s):8,fd_filestat_get(t,e){if(null!=l.fds[t]){let{ret:s,filestat:i}=l.fds[t].fd_filestat_get();return i?.write_bytes(new DataView(l.inst.exports.memory.buffer),e),s}return 8},fd_filestat_set_size:(t,e)=>null!=l.fds[t]?l.fds[t].fd_filestat_set_size(e):8,fd_filestat_set_times:(t,e,s,i)=>null!=l.fds[t]?l.fds[t].fd_filestat_set_times(e,s,i):8,fd_pread(t,e,s,i,n){let r=new DataView(l.inst.exports.memory.buffer),a=new Uint8Array(l.inst.exports.memory.buffer);if(null!=l.fds[t]){let d=K.read_bytes_array(r,e,s),{ret:h,nread:c}=l.fds[t].fd_pread(a,d,i);return r.setUint32(n,c,!0),h}return 8},fd_prestat_get(t,e){let s=new DataView(l.inst.exports.memory.buffer);if(null!=l.fds[t]){let{ret:i,prestat:n}=l.fds[t].fd_prestat_get();return n?.write_bytes(s,e),i}return 8},fd_prestat_dir_name(t,e,s){if(null!=l.fds[t]){let{ret:s,prestat_dir_name:i}=l.fds[t].fd_prestat_dir_name();return null!=i&&new Uint8Array(l.inst.exports.memory.buffer).set(i,e),s}return 8},fd_pwrite(t,e,s,i,n){let r=new DataView(l.inst.exports.memory.buffer),a=new Uint8Array(l.inst.exports.memory.buffer);if(null!=l.fds[t]){let d=k.read_bytes_array(r,e,s),{ret:h,nwritten:c}=l.fds[t].fd_pwrite(a,d,i);return r.setUint32(n,c,!0),h}return 8},fd_read(t,e,s,i){let n=new DataView(l.inst.exports.memory.buffer),r=new Uint8Array(l.inst.exports.memory.buffer);if(null!=l.fds[t]){let a=K.read_bytes_array(n,e,s),{ret:d,nread:h}=l.fds[t].fd_read(r,a);return n.setUint32(i,h,!0),d}return 8},fd_readdir(t,e,s,i,n){let r=new DataView(l.inst.exports.memory.buffer),a=new Uint8Array(l.inst.exports.memory.buffer);if(null!=l.fds[t]){let d=0;for(;;){let{ret:h,dirent:c}=l.fds[t].fd_readdir_single(i);if(0!=h)return r.setUint32(n,d,!0),h;if(null==c)break;if(s-d<c.head_length()){d=s;break}let o=new ArrayBuffer(c.head_length());if(c.write_head_bytes(new DataView(o),0),a.set(new Uint8Array(o).slice(0,Math.min(o.byteLength,s-d)),e),e+=c.head_length(),d+=c.head_length(),s-d<c.name_length()){d=s;break}c.write_name_bytes(a,e,s-d),e+=c.name_length(),d+=c.name_length(),i=c.d_next}return r.setUint32(n,d,!0),0}return 8},fd_renumber(t,e){if(null!=l.fds[t]&&null!=l.fds[e]){let s=l.fds[e].fd_close();return 0!=s?s:(l.fds[e]=l.fds[t],l.fds[t]=void 0,0)}return 8},fd_seek(t,e,s,i){let n=new DataView(l.inst.exports.memory.buffer);if(null!=l.fds[t]){let{ret:r,offset:a}=l.fds[t].fd_seek(e,s);return n.setBigInt64(i,a,!0),r}return 8},fd_sync:t=>null!=l.fds[t]?l.fds[t].fd_sync():8,fd_tell(t,e){let s=new DataView(l.inst.exports.memory.buffer);if(null!=l.fds[t]){let{ret:i,offset:n}=l.fds[t].fd_tell();return s.setBigUint64(e,n,!0),i}return 8},fd_write(t,e,s,i){let n=new DataView(l.inst.exports.memory.buffer),r=new Uint8Array(l.inst.exports.memory.buffer);if(null!=l.fds[t]){let a=k.read_bytes_array(n,e,s),{ret:d,nwritten:h}=l.fds[t].fd_write(r,a);return n.setUint32(i,h,!0),d}return 8},path_create_directory(t,e,s){let i=new Uint8Array(l.inst.exports.memory.buffer);if(null!=l.fds[t]){let n=new TextDecoder("utf-8").decode(i.slice(e,e+s));return l.fds[t].path_create_directory(n)}},path_filestat_get(t,e,s,i,n){let r=new DataView(l.inst.exports.memory.buffer),a=new Uint8Array(l.inst.exports.memory.buffer);if(null!=l.fds[t]){let d=new TextDecoder("utf-8").decode(a.slice(s,s+i)),{ret:h,filestat:c}=l.fds[t].path_filestat_get(e,d);return c?.write_bytes(r,n),h}return 8},path_filestat_set_times(t,e,s,i,n,r,a){let d=new Uint8Array(l.inst.exports.memory.buffer);if(null!=l.fds[t]){let h=new TextDecoder("utf-8").decode(d.slice(s,s+i));return l.fds[t].path_filestat_set_times(e,h,n,r,a)}return 8},path_link(t,e,s,i,n,r,a){let d=new Uint8Array(l.inst.exports.memory.buffer);if(null!=l.fds[t]&&null!=l.fds[n]){let h=new TextDecoder("utf-8").decode(d.slice(s,s+i)),c=new TextDecoder("utf-8").decode(d.slice(r,r+a));return l.fds[n].path_link(t,e,h,c)}return 8},path_open(t,e,s,i,n,r,a,d,h){let c=new DataView(l.inst.exports.memory.buffer),o=new Uint8Array(l.inst.exports.memory.buffer);if(null!=l.fds[t]){let u=new TextDecoder("utf-8").decode(o.slice(s,s+i)),{ret:m,fd_obj:p}=l.fds[t].path_open(e,u,n,r,a,d);if(0!=m)return m;l.fds.push(p);let b=l.fds.length-1;return c.setUint32(h,b,!0),0}return 8},path_readlink(t,e,s,i,n,r){let a=new DataView(l.inst.exports.memory.buffer),d=new Uint8Array(l.inst.exports.memory.buffer);if(null!=l.fds[t]){let h=new TextDecoder("utf-8").decode(d.slice(e,e+s)),{ret:c,data:o}=l.fds[t].path_readlink(h);if(null!=o){if(o.length>n)return a.setUint32(r,0,!0),8;d.set(o,i),a.setUint32(r,o.length,!0)}return c}return 8},path_remove_directory(t,e,s){let i=new Uint8Array(l.inst.exports.memory.buffer);if(null!=l.fds[t]){let n=new TextDecoder("utf-8").decode(i.slice(e,e+s));return l.fds[t].path_remove_directory(n)}return 8},path_rename(t,e,s,l,i,n){throw"FIXME what is the best abstraction for this?"},path_symlink(t,e,s,i,n){let r=new Uint8Array(l.inst.exports.memory.buffer);if(null!=l.fds[s]){let a=new TextDecoder("utf-8").decode(r.slice(t,t+e)),d=new TextDecoder("utf-8").decode(r.slice(i,i+n));return l.fds[s].path_symlink(a,d)}return 8},path_unlink_file(t,e,s){let i=new Uint8Array(l.inst.exports.memory.buffer);if(null!=l.fds[t]){let n=new TextDecoder("utf-8").decode(i.slice(e,e+s));return l.fds[t].path_unlink_file(n)}return 8},poll_oneoff(t,e,s){throw"async io not supported"},proc_exit(t){throw"exit with exit code "+t},proc_raise(t){throw"raised signal "+t},sched_yield(){},random_get(t,e){let s=new Uint8Array(l.inst.exports.memory.buffer);for(let l=0;l<e;l++)s[t+l]=256*Math.random()|0},sock_recv(t,e,s){throw"sockets not supported"},sock_send(t,e,s){throw"sockets not supported"},sock_shutdown(t,e){throw"sockets not supported"}}}},N=class{fd_advise(t,e,s){return-1}fd_allocate(t,e){return-1}fd_close(){return 0}fd_datasync(){return-1}fd_fdstat_get(){return{ret:-1,fdstat:null}}fd_fdstat_set_flags(t){return-1}fd_fdstat_set_rights(t,e){return-1}fd_filestat_get(){return{ret:-1,filestat:null}}fd_filestat_set_size(t){return-1}fd_filestat_set_times(t,e,s){return-1}fd_pread(t,e,s){return{ret:-1,nread:0}}fd_prestat_get(){return{ret:-1,prestat:null}}fd_prestat_dir_name(t,e){return{ret:-1,prestat_dir_name:null}}fd_pwrite(t,e,s){return{ret:-1,nwritten:0}}fd_read(t,e){return{ret:-1,nread:0}}fd_readdir_single(t){return{ret:-1,dirent:null}}fd_seek(t,e){return{ret:-1,offset:0n}}fd_sync(){return 0}fd_tell(){return{ret:-1,offset:0n}}fd_write(t,e){return{ret:-1,nwritten:0}}path_create_directory(t){return-1}path_filestat_get(t,e){return{ret:-1,filestat:null}}path_filestat_set_times(t,e,s,l,i){return-1}path_link(t,e,s,l){return-1}path_open(t,e,s,l,i,n){return{ret:-1,fd_obj:null}}path_readlink(t){return{ret:-1,data:null}}path_remove_directory(t){return-1}path_rename(t,e,s){return-1}path_symlink(t,e){return-1}path_unlink_file(t){return-1}},B=class{get size(){return BigInt(this.data.byteLength)}stat(){return new F(4,this.size)}truncate(){this.data=new Uint8Array([])}constructor(t){this.data=new Uint8Array(t)}},M=class extends N{fd_fdstat_get(){return{ret:0,fdstat:new J(4,0)}}fd_read(t,e){let s=0;for(let l of e){if(!(this.file_pos<this.file.data.byteLength))break;{let e=this.file.data.slice(Number(this.file_pos),Number(this.file_pos+BigInt(l.buf_len)));t.set(e,l.buf),this.file_pos+=BigInt(e.length),s+=e.length}}return{ret:0,nread:s}}fd_seek(t,e){let s;switch(e){case 0:s=t;break;case 1:s=this.file_pos+t;break;case 2:s=BigInt(this.file.data.byteLength)+t;break;default:return{ret:28,offset:0n}}return s<0?{ret:28,offset:0n}:(this.file_pos=s,{ret:0,offset:this.file_pos})}fd_write(t,e){let s=0;for(let l of e){let e=t.slice(l.buf,l.buf+l.buf_len);if(this.file_pos+BigInt(e.byteLength)>this.file.size){let t=this.file.data;this.file.data=new Uint8Array(Number(this.file_pos+BigInt(e.byteLength))),this.file.data.set(t)}this.file.data.set(e.slice(0,Number(this.file.size-this.file_pos)),Number(this.file_pos)),this.file_pos+=BigInt(e.byteLength),s+=l.buf_len}return{ret:0,nwritten:s}}fd_filestat_get(){return{ret:0,filestat:this.file.stat()}}constructor(t){super(),this.file_pos=0n,this.file=t}},v="extism:host/env",T=class{#t;#e;#s;#l=!1;constructor(t,e,s){this.#t=t,this.#s=e,this.#e=s}async reset(){return!this.isActive()&&(this.#t[z](),!0)}isActive(){return this.#l}async functionExists(t){try{let e=[].concat(t),[s,l]=2===e.length?[this.lookupTarget(e[0]),e[1]]:[this.#e.find((t=>WebAssembly.Module.exports(t.module).find((t=>t.name===e[0]&&"function"===t.kind)))),e[0]];return!(!s||!s.instance.exports[l])}catch{return!1}}async callBlock(t,e){this.#l=!0;let s=[].concat(t),[l,i]=2===s.length?[this.lookupTarget(s[0]),s[1]]:[this.#e.find((t=>WebAssembly.Module.exports(t.module).find((t=>t.name===s[0]&&"function"===t.kind)))),s[0]];if(!l)throw Error(`Plugin error: target "${s.join('" "')}" does not exist`);let n=l.instance.exports[i];if(!n)throw Error(`Plugin error: function "${s.join('" "')}" does not exist`);this.#t[g](e??null);try{return n(),this.#t[w]()}catch(t){throw this.#t[w](),t}finally{this.#l=!1}}async call(t,e){let s=this.#t[H](e),[l,i]=await this.callBlock(t,s),n=null!==l,r=l??i;if(null===r)return null;let a=this.#t[R](r);if(!a)return null;let d=new W(a.buffer);if(n)throw new Error(`Plugin-originated error: ${d.string()}`);return d}lookupTarget(t){let e=String(t??"0"),s=this.#s.findIndex((t=>t===e));if(-1===s)throw new Error(`no module named "${t}"`);return this.#e[s]}async getExports(t){return WebAssembly.Module.exports(this.lookupTarget(t).module)||[]}async getImports(t){return WebAssembly.Module.imports(this.lookupTarget(t).module)||[]}async getInstance(t){return this.lookupTarget(t).instance}async close(){}};async function Q(t,e,s,l=new S(ArrayBuffer,t.logger,t.config)){let i=t.wasiEnabled?await async function(t){let e=[new M(new B([])),new M(new B([])),new M(new B([]))],s=new C([],[],e);return{importObject:async()=>s.wasiImport,async initialize(t){let e=t.exports.memory;if(!e)throw new Error("The module has to export a default memory.");if(t.exports._initialize){let l=t.exports._initialize;s.initialize?s.initialize({exports:{memory:e,_initialize:()=>{l()}}}):l()}else t.exports._start&&s.start({exports:{memory:e,_start:()=>{}}})}}}(t.allowedPaths):null,n={...i?{wasi_snapshot_preview1:await i.importObject()}:{},[v]:l[x],env:{}};for(let e in t.functions){n[e]=n[e]||{};for(let s in t.functions[e])n[e][s]=t.functions[e][s].bind(null,l)}let r=await Promise.all(s.map((async t=>{let e=await WebAssembly.instantiate(t,n);i&&await(i?.initialize(e));let s=e.exports.hs_init?"haskell":e.exports._initialize?"reactor":e.exports._start?"command":"none";return(e.exports.hs_init?e.exports.hs_init:()=>{})(),{module:t,instance:e,guestType:s}})));return new T(l,e,r)}var U,E,_,P,j,O,A,D,$,q,tt,et,st,lt,it,nt,rt,at,dt,ht,ct,ot=new URL("data:text/javascript;base64,dmFyIGZ0PU9iamVjdC5kZWZpbmVQcm9wZXJ0eTt2YXIgdXQ9KHUsdCxyKT0+dCBpbiB1P2Z0KHUsdCx7ZW51bWVyYWJsZTohMCxjb25maWd1cmFibGU6ITAsd3JpdGFibGU6ITAsdmFsdWU6cn0pOnVbdF09cjt2YXIgRz0odSx0LHIpPT4odXQodSx0eXBlb2YgdCE9InN5bWJvbCI/dCsiIjp0LHIpLHIpLFE9KHUsdCxyKT0+e2lmKCF0Lmhhcyh1KSl0aHJvdyBUeXBlRXJyb3IoIkNhbm5vdCAiK3IpfTt2YXIgUz0odSx0LHIpPT4oUSh1LHQsInJlYWQgZnJvbSBwcml2YXRlIGZpZWxkIikscj9yLmNhbGwodSk6dC5nZXQodSkpLE09KHUsdCxyKT0+e2lmKHQuaGFzKHUpKXRocm93IFR5cGVFcnJvcigiQ2Fubm90IGFkZCB0aGUgc2FtZSBwcml2YXRlIG1lbWJlciBtb3JlIHRoYW4gb25jZSIpO3QgaW5zdGFuY2VvZiBXZWFrU2V0P3QuYWRkKHUpOnQuc2V0KHUscil9LFo9KHUsdCxyLHMpPT4oUSh1LHQsIndyaXRlIHRvIHByaXZhdGUgZmllbGQiKSxzP3MuY2FsbCh1LHIpOnQuc2V0KHUscikscik7dmFyIHE9e29uKHUsdCl7YWRkRXZlbnRMaXN0ZW5lcih1LHI9Pnt0KHIuZGF0YSl9KX0scG9zdE1lc3NhZ2UodSx0PVtdKXtzZWxmLnBvc3RNZXNzYWdlKHUsdCl9fTt2YXIgRCxPLEg9Y2xhc3MgZXh0ZW5kcyBEYXRhVmlld3tjb25zdHJ1Y3RvcihyKXtzdXBlcihyKTtNKHRoaXMsTyxudWxsKX1qc29uKCl7cmV0dXJuIEpTT04ucGFyc2UodGhpcy5zdHJpbmcoKSl9YXJyYXlCdWZmZXIoKXtyZXR1cm4gdGhpcy5idWZmZXJ9dGV4dCgpe3JldHVybiB0aGlzLnN0cmluZygpfXN0cmluZygpe3JldHVybiBTKEgsRCkuZGVjb2RlKHRoaXMuYnVmZmVyKX1ieXRlcygpe3JldHVybiBTKHRoaXMsTyk/P1oodGhpcyxPLG5ldyBVaW50OEFycmF5KHRoaXMuYnVmZmVyKSksUyh0aGlzLE8pfXNldEludDgocixzKXt0aHJvdyBuZXcgRXJyb3IoIkNhbm5vdCBzZXQgdmFsdWVzIG9uIG91dHB1dCIpfXNldEludDE2KHIscyxlKXt0aHJvdyBuZXcgRXJyb3IoIkNhbm5vdCBzZXQgdmFsdWVzIG9uIG91dHB1dCIpfXNldEludDMyKHIscyxlKXt0aHJvdyBuZXcgRXJyb3IoIkNhbm5vdCBzZXQgdmFsdWVzIG9uIG91dHB1dCIpfXNldFVpbnQ4KHIscyl7dGhyb3cgbmV3IEVycm9yKCJDYW5ub3Qgc2V0IHZhbHVlcyBvbiBvdXRwdXQiKX1zZXRVaW50MTYocixzLGUpe3Rocm93IG5ldyBFcnJvcigiQ2Fubm90IHNldCB2YWx1ZXMgb24gb3V0cHV0Iil9c2V0VWludDMyKHIscyxlKXt0aHJvdyBuZXcgRXJyb3IoIkNhbm5vdCBzZXQgdmFsdWVzIG9uIG91dHB1dCIpfXNldEZsb2F0MzIocixzLGUpe3Rocm93IG5ldyBFcnJvcigiQ2Fubm90IHNldCB2YWx1ZXMgb24gb3V0cHV0Iil9c2V0RmxvYXQ2NChyLHMsZSl7dGhyb3cgbmV3IEVycm9yKCJDYW5ub3Qgc2V0IHZhbHVlcyBvbiBvdXRwdXQiKX1zZXRCaWdJbnQ2NChyLHMsZSl7dGhyb3cgbmV3IEVycm9yKCJDYW5ub3Qgc2V0IHZhbHVlcyBvbiBvdXRwdXQiKX1zZXRCaWdVaW50NjQocixzLGUpe3Rocm93IG5ldyBFcnJvcigiQ2Fubm90IHNldCB2YWx1ZXMgb24gb3V0cHV0Iil9fSx3PUg7RD1uZXcgV2Vha01hcCxPPW5ldyBXZWFrTWFwLE0odyxELG5ldyBUZXh0RGVjb2Rlcik7dmFyIEo9e2FsbG93U2hhcmVkQnVmZmVyQ29kZWM6ITEsbWFuaWZlc3RTdXBwb3J0c1BhdGhzOiExLGNyb3NzT3JpZ2luQ2hlY2tzRW5mb3JjZWQ6ITAsZnNBY2Nlc3M6ITEsaGFzV29ya2VyQ2FwYWJpbGl0eTp0eXBlb2YgZ2xvYmFsVGhpczwidSI/Z2xvYmFsVGhpcy5jcm9zc09yaWdpbklzb2xhdGVkJiZ0eXBlb2YgU2hhcmVkQXJyYXlCdWZmZXI8InUiOiEwLHN1cHBvcnRzV2FzaVByZXZpZXcxOiEwfTt2YXIgdj1TeW1ib2woImJlZ2luIiksTD1TeW1ib2woImVuZCIpLFc9U3ltYm9sKCJlbnYiKSxWPVN5bWJvbCgiZ2V0LWJsb2NrIiksQz1TeW1ib2woImltcG9ydC1zdGF0ZSIpLEY9U3ltYm9sKCJleHBvcnQtc3RhdGUiKSxUPVN5bWJvbCgic3RvcmUtdmFsdWUiKSxZPVN5bWJvbCgicmVzZXQiKSxfPWNsYXNze2J1ZmZlcjt2aWV3O2xvY2FsO2dldCBieXRlTGVuZ3RoKCl7cmV0dXJuIHRoaXMuYnVmZmVyLmJ5dGVMZW5ndGh9Y29uc3RydWN0b3IodCxyKXt0aGlzLmJ1ZmZlcj10LHRoaXMudmlldz1uZXcgRGF0YVZpZXcodGhpcy5idWZmZXIpLHRoaXMubG9jYWw9cn1zdGF0aWMgaW5kZXhUb0FkZHJlc3ModCl7cmV0dXJuIEJpZ0ludCh0KTw8NDhufXN0YXRpYyBhZGRyZXNzVG9JbmRleCh0KXtyZXR1cm4gTnVtYmVyKEJpZ0ludCh0KT4+NDhuKX1zdGF0aWMgbWFza0FkZHJlc3ModCl7cmV0dXJuIE51bWJlcihCaWdJbnQodCkmKDFuPDw0OG4pLTFuKX19LEE9Y2xhc3N7I2U7I3Q9W107I3I7I247I2w7I2k7I287I3M9bmV3IE1hcDtjb25zdHJ1Y3Rvcih0LHIscyl7dGhpcy4jaT10LHRoaXMuI3I9cix0aGlzLiNuPW5ldyBUZXh0RGVjb2Rlcix0aGlzLiNsPW5ldyBUZXh0RW5jb2Rlcix0aGlzLiNlPVtdLHRoaXMuYWxsb2MoMSksdGhpcy4jbz1zfWFsbG9jKHQpe2xldCByPW5ldyBfKG5ldyB0aGlzLiNpKE51bWJlcih0KSksITApLHM9dGhpcy4jdC5sZW5ndGg7cmV0dXJuIHRoaXMuI3QucHVzaChyKSxfLmluZGV4VG9BZGRyZXNzKHMpfWdldFZhcmlhYmxlKHQpe3JldHVybiB0aGlzLiNzLmhhcyh0KT90aGlzLnJlYWQodGhpcy4jcy5nZXQodCkpOm51bGx9c2V0VmFyaWFibGUodCxyKXtsZXQgcz10aGlzW1RdKHIpO2lmKHM9PT1udWxsKXJldHVybiAwbjtsZXQgZT10aGlzLiNzLmdldCh0KT8/bnVsbDtyZXR1cm4gZSE9PW51bGwmJih0aGlzLiN0W2VdPXRoaXMuI3Rbc10sdGhpcy4jdFtzXT1udWxsLHM9PT10aGlzLiN0Lmxlbmd0aC0xJiZ0aGlzLiN0LnBvcCgpKSx0aGlzLiNzLnNldCh0LGU/P3MpLF8uaW5kZXhUb0FkZHJlc3MoZT8/cyl9cmVhZCh0KXtsZXQgcj1fLmFkZHJlc3NUb0luZGV4KHQpLHM9dGhpcy4jdFtyXTtpZighcylyZXR1cm4gbnVsbDtsZXQgZT0hKHMuYnVmZmVyIGluc3RhbmNlb2YgQXJyYXlCdWZmZXIpJiYhSi5hbGxvd1NoYXJlZEJ1ZmZlckNvZGVjP25ldyBVaW50OEFycmF5KHMuYnVmZmVyKS5zbGljZSgpLmJ1ZmZlcjpzLmJ1ZmZlcjtyZXR1cm4gbmV3IHcoZSl9c3RvcmUodCl7bGV0IHI9dGhpc1tUXSh0KTtpZighcil0aHJvdyBuZXcgRXJyb3IoImZhaWxlZCB0byBzdG9yZSBvdXRwdXQiKTtyZXR1cm4gXy5pbmRleFRvQWRkcmVzcyhyKX1bV109e2FsbG9jOnQ9PnRoaXMuYWxsb2ModCksZnJlZTp0PT57dGhpcy4jdFtfLmFkZHJlc3NUb0luZGV4KHQpXT1udWxsfSxsb2FkX3U4OnQ9PntsZXQgcj1fLmFkZHJlc3NUb0luZGV4KHQpLHM9Xy5tYXNrQWRkcmVzcyh0KTtyZXR1cm4gdGhpcy4jdFtyXT8udmlldy5nZXRVaW50OChOdW1iZXIocykpfSxsb2FkX3U2NDp0PT57bGV0IHI9Xy5hZGRyZXNzVG9JbmRleCh0KSxzPV8ubWFza0FkZHJlc3ModCk7cmV0dXJuIHRoaXMuI3Rbcl0/LnZpZXcuZ2V0QmlnVWludDY0KE51bWJlcihzKSwhMCl9LHN0b3JlX3U4Oih0LHIpPT57bGV0IHM9Xy5hZGRyZXNzVG9JbmRleCh0KSxlPV8ubWFza0FkZHJlc3ModCk7dGhpcy4jdFtzXT8udmlldy5zZXRVaW50OChOdW1iZXIoZSksTnVtYmVyKHIpKX0sc3RvcmVfdTY0Oih0LHIpPT57bGV0IHM9Xy5hZGRyZXNzVG9JbmRleCh0KSxlPV8ubWFza0FkZHJlc3ModCk7dGhpcy4jdFtzXT8udmlldy5zZXRCaWdVaW50NjQoTnVtYmVyKGUpLHIsITApfSxpbnB1dF9sZW5ndGg6KCk9PkJpZ0ludCh0aGlzLiNhPy5ieXRlTGVuZ3RoPz8wKSxpbnB1dF9sb2FkX3U4OnQ9PntsZXQgcj1fLm1hc2tBZGRyZXNzKHQpO3JldHVybiB0aGlzLiNhPy52aWV3LmdldFVpbnQ4KE51bWJlcihyKSl9LGlucHV0X2xvYWRfdTY0OnQ9PntsZXQgcj1fLm1hc2tBZGRyZXNzKHQpO3JldHVybiB0aGlzLiNhPy52aWV3LmdldEJpZ1VpbnQ2NChOdW1iZXIociksITApfSxvdXRwdXRfc2V0Oih0LHIpPT57bGV0IHM9Xy5hZGRyZXNzVG9JbmRleCh0KSxlPXRoaXMuI3Rbc107aWYoIWUpdGhyb3cgbmV3IEVycm9yKGBjYW5ub3QgYXNzaWduIHRvIHRoaXMgYmxvY2sgKGFkZHI9JHt0LnRvU3RyaW5nKDE2KS5wYWRTdGFydCgxNiwiMCIpfTsgbGVuZ3RoPSR7cn0pYCk7aWYocj5lLmJ1ZmZlci5ieXRlTGVuZ3RoKXRocm93IG5ldyBFcnJvcigibGVuZ3RoIGxvbmdlciB0aGFuIHRhcmdldCBibG9jayIpO3RoaXMuI2VbdGhpcy4jZS5sZW5ndGgtMV1bMV09c30sZXJyb3Jfc2V0OnQ9PntsZXQgcj1fLmFkZHJlc3NUb0luZGV4KHQpO2lmKCF0aGlzLiN0W3JdKXRocm93IG5ldyBFcnJvcigiY2Fubm90IGFzc2lnbiB0byB0aGlzIGJsb2NrIik7dGhpcy4jZVt0aGlzLiNlLmxlbmd0aC0xXVsyXT1yfSxjb25maWdfZ2V0OnQ9PntsZXQgcj10aGlzLnJlYWQodCk7aWYocj09PW51bGwpcmV0dXJuIDBuO2xldCBzPXIuc3RyaW5nKCk7cmV0dXJuIHMgaW4gdGhpcy4jbz90aGlzLnN0b3JlKHRoaXMuI29bc10pOjBufSx2YXJfZ2V0OnQ9PntsZXQgcj10aGlzLnJlYWQodCk7aWYocj09PW51bGwpcmV0dXJuIDBuO2xldCBzPXIuc3RyaW5nKCk7cmV0dXJuIHRoaXMuI3MuaGFzKHMpP18uaW5kZXhUb0FkZHJlc3ModGhpcy4jcy5nZXQocykpOjBufSx2YXJfc2V0Oih0LHIpPT57bGV0IHM9dGhpcy5yZWFkKHQpO2lmKHM9PT1udWxsKXJldHVybiAwbjtsZXQgZT1zLnN0cmluZygpO2lmKHI9PT0wbilyZXR1cm4gdGhpcy4jcy5kZWxldGUoZSksMG47dGhpcy4jcy5zZXQoZSxfLmFkZHJlc3NUb0luZGV4KHIpKX0saHR0cF9yZXF1ZXN0Oih0LHIpPT4odGhpcy4jci5lcnJvcigiaHR0cF9yZXF1ZXN0IGlzIG5vdCBlbmFibGVkIiksMG4pLGh0dHBfc3RhdHVzX2NvZGU6KCk9Pih0aGlzLiNyLmVycm9yKCJodHRwX3N0YXR1c19jb2RlIGlzIG5vdCBlbmFibGVkIiksMCksbGVuZ3RoOnQ9PntsZXQgcj1fLmFkZHJlc3NUb0luZGV4KHQpLHM9dGhpcy4jdFtyXTtyZXR1cm4gcz9CaWdJbnQocy5idWZmZXIuYnl0ZUxlbmd0aCk6MG59LGxvZ193YXJuOnQ9PntsZXQgcj1fLmFkZHJlc3NUb0luZGV4KHQpLHM9dGhpcy4jdFtyXTtpZighcylyZXR1cm4gdGhpcy4jci5lcnJvcihgZmFpbGVkIHRvIGxvZyh3YXJuKTogYmFkIGJsb2NrIHJlZmVyZW5jZSBpbiBhZGRyIDB4JHt0LnRvU3RyaW5nKDE2KS5wYWRTdGFydCg2NCwiMCIpfWApO2xldCBlPXRoaXMuI24uZGVjb2RlKHMuYnVmZmVyKTt0aGlzLiNyLndhcm4oZSl9LGxvZ19pbmZvOnQ9PntsZXQgcj1fLmFkZHJlc3NUb0luZGV4KHQpLHM9dGhpcy4jdFtyXTtpZighcylyZXR1cm4gdGhpcy4jci5lcnJvcihgZmFpbGVkIHRvIGxvZyhpbmZvKTogYmFkIGJsb2NrIHJlZmVyZW5jZSBpbiBhZGRyIDB4JHt0LnRvU3RyaW5nKDE2KS5wYWRTdGFydCg2NCwiMCIpfWApO2xldCBlPXRoaXMuI24uZGVjb2RlKHMuYnVmZmVyKTt0aGlzLiNyLmluZm8oZSl9LGxvZ19kZWJ1Zzp0PT57bGV0IHI9Xy5hZGRyZXNzVG9JbmRleCh0KSxzPXRoaXMuI3Rbcl07aWYoIXMpcmV0dXJuIHRoaXMuI3IuZXJyb3IoYGZhaWxlZCB0byBsb2coZGVidWcpOiBiYWQgYmxvY2sgcmVmZXJlbmNlIGluIGFkZHIgMHgke3QudG9TdHJpbmcoMTYpLnBhZFN0YXJ0KDY0LCIwIil9YCk7bGV0IGU9dGhpcy4jbi5kZWNvZGUocy5idWZmZXIpO3RoaXMuI3IuZGVidWcoZSl9LGxvZ19lcnJvcjp0PT57bGV0IHI9Xy5hZGRyZXNzVG9JbmRleCh0KSxzPXRoaXMuI3Rbcl07aWYoIXMpcmV0dXJuIHRoaXMuI3IuZXJyb3IoYGZhaWxlZCB0byBsb2coZXJyb3IpOiBiYWQgYmxvY2sgcmVmZXJlbmNlIGluIGFkZHIgMHgke3QudG9TdHJpbmcoMTYpLnBhZFN0YXJ0KDY0LCIwIil9YCk7bGV0IGU9dGhpcy4jbi5kZWNvZGUocy5idWZmZXIpO3RoaXMuI3IuZXJyb3IoZSl9fTtnZXQjYSgpe2xldCB0PXRoaXMuI2VbdGhpcy4jZS5sZW5ndGgtMV1bMF07cmV0dXJuIHQ9PT1udWxsP251bGw6dGhpcy4jdFt0XX1bWV0oKXt0aGlzLiN0Lmxlbmd0aD0xLHRoaXMuI2UubGVuZ3RoPTB9W1ZdKHQpe2xldCByPXRoaXMuI3RbdF07aWYoIXIpdGhyb3cgbmV3IEVycm9yKGBpbnZhbGlkIGJsb2NrIGluZGV4OiAke3R9YCk7cmV0dXJuIHJ9W0NdKHQscj0hMSl7Zm9yKGxldFtzLGVdb2YgdC5ibG9ja3Mpe2lmKHMmJnIpe2xldCBuPW5ldyBVaW50OEFycmF5KG5ldyB0aGlzLiNpKE51bWJlcihzLmJ5dGVMZW5ndGgpKSk7bi5zZXQobmV3IFVpbnQ4QXJyYXkocykpLHM9bi5idWZmZXJ9dGhpcy4jdFtlXT1zP25ldyBfKHMsITEpOm51bGx9dGhpcy4jZT10LnN0YWNrfVtGXSgpe3JldHVybntzdGFjazp0aGlzLiNlLnNsaWNlKCksYmxvY2tzOnRoaXMuI3QubWFwKCh0LHIpPT50P3QubG9jYWw/KHQubG9jYWw9ITEsW3QuYnVmZmVyLHJdKTpudWxsOltudWxsLHJdKS5maWx0ZXIoQm9vbGVhbil9fVtUXSh0KXtpZighdClyZXR1cm4gbnVsbDtpZih0eXBlb2YgdD09InN0cmluZyImJih0PXRoaXMuI2wuZW5jb2RlKHQpKSx0IGluc3RhbmNlb2YgVWludDhBcnJheSl7aWYodC5idWZmZXIuY29uc3RydWN0b3I9PT10aGlzLiNpKXtsZXQgbj10aGlzLiN0Lmxlbmd0aDtyZXR1cm4gdGhpcy4jdC5wdXNoKG5ldyBfKHQuYnVmZmVyLCEwKSksbn1sZXQgcj1fLmFkZHJlc3NUb0luZGV4KHRoaXMuYWxsb2ModC5sZW5ndGgpKSxzPXRoaXMuI3Rbcl07cmV0dXJuIG5ldyBVaW50OEFycmF5KHMuYnVmZmVyKS5zZXQodCwwKSxyfXJldHVybiB0fVt2XSh0KXt0aGlzLiNlLnB1c2goW3QsbnVsbCxudWxsXSl9W0xdKCl7bGV0Wyx0LHJdPXRoaXMuI2UucG9wKCkscz1yPT09bnVsbD8xOjAsZT1yPz90LG49W251bGwsbnVsbF07cmV0dXJuIGU9PT1udWxsfHx0aGlzLiN0W2VdPT09bnVsbHx8KG5bc109ZSksbn19O3ZhciB4PWNsYXNze3N0YXRpYyByZWFkX2J5dGVzKHQscil7bGV0IHM9bmV3IHg7cmV0dXJuIHMuYnVmPXQuZ2V0VWludDMyKHIsITApLHMuYnVmX2xlbj10LmdldFVpbnQzMihyKzQsITApLHN9c3RhdGljIHJlYWRfYnl0ZXNfYXJyYXkodCxyLHMpe2xldCBlPVtdO2ZvcihsZXQgbj0wO248cztuKyspZS5wdXNoKHgucmVhZF9ieXRlcyh0LHIrOCpuKSk7cmV0dXJuIGV9fSxtPWNsYXNze3N0YXRpYyByZWFkX2J5dGVzKHQscil7bGV0IHM9bmV3IG07cmV0dXJuIHMuYnVmPXQuZ2V0VWludDMyKHIsITApLHMuYnVmX2xlbj10LmdldFVpbnQzMihyKzQsITApLHN9c3RhdGljIHJlYWRfYnl0ZXNfYXJyYXkodCxyLHMpe2xldCBlPVtdO2ZvcihsZXQgbj0wO248cztuKyspZS5wdXNoKG0ucmVhZF9ieXRlcyh0LHIrOCpuKSk7cmV0dXJuIGV9fSx0dD0wLGV0PTEscnQ9Mjt2YXIgQj00O3ZhciBOdD0xPDwwLFN0PTE8PDEsRHQ9MTw8MixMdD0xPDwzLEN0PTE8PDQsaz1jbGFzc3t3cml0ZV9ieXRlcyh0LHIpe3Quc2V0VWludDgocix0aGlzLmZzX2ZpbGV0eXBlKSx0LnNldFVpbnQxNihyKzIsdGhpcy5mc19mbGFncywhMCksdC5zZXRCaWdVaW50NjQocis4LHRoaXMuZnNfcmlnaHRzX2Jhc2UsITApLHQuc2V0QmlnVWludDY0KHIrMTYsdGhpcy5mc19yaWdodHNfaW5oZXJpdGVkLCEwKX1jb25zdHJ1Y3Rvcih0LHIpe3RoaXMuZnNfcmlnaHRzX2Jhc2U9MG4sdGhpcy5mc19yaWdodHNfaW5oZXJpdGVkPTBuLHRoaXMuZnNfZmlsZXR5cGU9dCx0aGlzLmZzX2ZsYWdzPXJ9fSxGdD0xPDwwLGt0PTE8PDEsVXQ9MTw8MixCdD0xPDwzLGN0PTE8PDAsZHQ9MTw8MSxfdD0xPDwyLGh0PTE8PDMsVT1jbGFzc3t3cml0ZV9ieXRlcyh0LHIpe3Quc2V0QmlnVWludDY0KHIsdGhpcy5kZXYsITApLHQuc2V0QmlnVWludDY0KHIrOCx0aGlzLmlubywhMCksdC5zZXRVaW50OChyKzE2LHRoaXMuZmlsZXR5cGUpLHQuc2V0QmlnVWludDY0KHIrMjQsdGhpcy5ubGluaywhMCksdC5zZXRCaWdVaW50NjQociszMix0aGlzLnNpemUsITApLHQuc2V0QmlnVWludDY0KHIrMzgsdGhpcy5hdGltLCEwKSx0LnNldEJpZ1VpbnQ2NChyKzQ2LHRoaXMubXRpbSwhMCksdC5zZXRCaWdVaW50NjQocis1Mix0aGlzLmN0aW0sITApfWNvbnN0cnVjdG9yKHQscil7dGhpcy5kZXY9MG4sdGhpcy5pbm89MG4sdGhpcy5ubGluaz0wbix0aGlzLmF0aW09MG4sdGhpcy5tdGltPTBuLHRoaXMuY3RpbT0wbix0aGlzLmZpbGV0eXBlPXQsdGhpcy5zaXplPXJ9fTt2YXIgUHQ9MTw8MCxHdD0xPDwwO3ZhciBNdD0xPDwwLEh0PTE8PDEsdnQ9MTw8MCxXdD0xPDwwLFZ0PTE8PDE7dmFyIHo9Y2xhc3N7c3RhcnQodCl7dGhpcy5pbnN0PXQsdC5leHBvcnRzLl9zdGFydCgpfWluaXRpYWxpemUodCl7dGhpcy5pbnN0PXQsdC5leHBvcnRzLl9pbml0aWFsaXplKCl9Y29uc3RydWN0b3IodCxyLHMpe3RoaXMuYXJncz1bXSx0aGlzLmVudj1bXSx0aGlzLmZkcz1bXSx0aGlzLmFyZ3M9dCx0aGlzLmVudj1yLHRoaXMuZmRzPXM7bGV0IGU9dGhpczt0aGlzLndhc2lJbXBvcnQ9e2FyZ3Nfc2l6ZXNfZ2V0KG4saSl7bGV0IG89bmV3IERhdGFWaWV3KGUuaW5zdC5leHBvcnRzLm1lbW9yeS5idWZmZXIpO28uc2V0VWludDMyKG4sZS5hcmdzLmxlbmd0aCwhMCk7bGV0IGE9MDtmb3IobGV0IGwgb2YgZS5hcmdzKWErPWwubGVuZ3RoKzE7cmV0dXJuIG8uc2V0VWludDMyKGksYSwhMCksMH0sYXJnc19nZXQobixpKXtsZXQgbz1uZXcgRGF0YVZpZXcoZS5pbnN0LmV4cG9ydHMubWVtb3J5LmJ1ZmZlciksYT1uZXcgVWludDhBcnJheShlLmluc3QuZXhwb3J0cy5tZW1vcnkuYnVmZmVyKSxsPWk7Zm9yKGxldCBmPTA7ZjxlLmFyZ3MubGVuZ3RoO2YrKyl7by5zZXRVaW50MzIobixpLCEwKSxuKz00O2xldCBjPW5ldyBUZXh0RW5jb2RlcigidXRmLTgiKS5lbmNvZGUoZS5hcmdzW2ZdKTthLnNldChjLGkpLG8uc2V0VWludDgoaStjLmxlbmd0aCwwKSxpKz1jLmxlbmd0aCsxfXJldHVybiAwfSxlbnZpcm9uX3NpemVzX2dldChuLGkpe2xldCBvPW5ldyBEYXRhVmlldyhlLmluc3QuZXhwb3J0cy5tZW1vcnkuYnVmZmVyKTtvLnNldFVpbnQzMihuLGUuZW52Lmxlbmd0aCwhMCk7bGV0IGE9MDtmb3IobGV0IGwgb2YgZS5lbnYpYSs9bC5sZW5ndGgrMTtyZXR1cm4gby5zZXRVaW50MzIoaSxhLCEwKSwwfSxlbnZpcm9uX2dldChuLGkpe2xldCBvPW5ldyBEYXRhVmlldyhlLmluc3QuZXhwb3J0cy5tZW1vcnkuYnVmZmVyKSxhPW5ldyBVaW50OEFycmF5KGUuaW5zdC5leHBvcnRzLm1lbW9yeS5idWZmZXIpLGw9aTtmb3IobGV0IGY9MDtmPHIubGVuZ3RoO2YrKyl7by5zZXRVaW50MzIobixpLCEwKSxuKz00O2xldCBjPW5ldyBUZXh0RW5jb2RlcigidXRmLTgiKS5lbmNvZGUocltmXSk7YS5zZXQoYyxpKSxvLnNldFVpbnQ4KGkrYy5sZW5ndGgsMCksaSs9Yy5sZW5ndGgrMX1yZXR1cm4gMH0sY2xvY2tfcmVzX2dldChuLGkpe3Rocm93InVuaW1wbGVtZW50ZWQifSxjbG9ja190aW1lX2dldChuLGksbyl7bGV0IGE9bmV3IERhdGFWaWV3KGUuaW5zdC5leHBvcnRzLm1lbW9yeS5idWZmZXIpO2lmKG49PT0wKWEuc2V0QmlnVWludDY0KG8sQmlnSW50KG5ldyBEYXRlKCkuZ2V0VGltZSgpKSoxMDAwMDAwbiwhMCk7ZWxzZSBpZihuPT0xKXtsZXQgbDt0cnl7bD1CaWdJbnQoTWF0aC5yb3VuZChwZXJmb3JtYW5jZS5ub3coKSoxZTYpKX1jYXRjaHtsPTBufWEuc2V0QmlnVWludDY0KG8sbCwhMCl9ZWxzZSBhLnNldEJpZ1VpbnQ2NChvLDBuLCEwKTtyZXR1cm4gMH0sZmRfYWR2aXNlKG4saSxvLGEpe3JldHVybiBlLmZkc1tuXSE9bnVsbD9lLmZkc1tuXS5mZF9hZHZpc2UoaSxvLGEpOjh9LGZkX2FsbG9jYXRlKG4saSxvKXtyZXR1cm4gZS5mZHNbbl0hPW51bGw/ZS5mZHNbbl0uZmRfYWxsb2NhdGUoaSxvKTo4fSxmZF9jbG9zZShuKXtpZihlLmZkc1tuXSE9bnVsbCl7bGV0IGk9ZS5mZHNbbl0uZmRfY2xvc2UoKTtyZXR1cm4gZS5mZHNbbl09dm9pZCAwLGl9ZWxzZSByZXR1cm4gOH0sZmRfZGF0YXN5bmMobil7cmV0dXJuIGUuZmRzW25dIT1udWxsP2UuZmRzW25dLmZkX2RhdGFzeW5jKCk6OH0sZmRfZmRzdGF0X2dldChuLGkpe2lmKGUuZmRzW25dIT1udWxsKXtsZXR7cmV0Om8sZmRzdGF0OmF9PWUuZmRzW25dLmZkX2Zkc3RhdF9nZXQoKTtyZXR1cm4gYT8ud3JpdGVfYnl0ZXMobmV3IERhdGFWaWV3KGUuaW5zdC5leHBvcnRzLm1lbW9yeS5idWZmZXIpLGkpLG99ZWxzZSByZXR1cm4gOH0sZmRfZmRzdGF0X3NldF9mbGFncyhuLGkpe3JldHVybiBlLmZkc1tuXSE9bnVsbD9lLmZkc1tuXS5mZF9mZHN0YXRfc2V0X2ZsYWdzKGkpOjh9LGZkX2Zkc3RhdF9zZXRfcmlnaHRzKG4saSxvKXtyZXR1cm4gZS5mZHNbbl0hPW51bGw/ZS5mZHNbbl0uZmRfZmRzdGF0X3NldF9yaWdodHMoaSxvKTo4fSxmZF9maWxlc3RhdF9nZXQobixpKXtpZihlLmZkc1tuXSE9bnVsbCl7bGV0e3JldDpvLGZpbGVzdGF0OmF9PWUuZmRzW25dLmZkX2ZpbGVzdGF0X2dldCgpO3JldHVybiBhPy53cml0ZV9ieXRlcyhuZXcgRGF0YVZpZXcoZS5pbnN0LmV4cG9ydHMubWVtb3J5LmJ1ZmZlciksaSksb31lbHNlIHJldHVybiA4fSxmZF9maWxlc3RhdF9zZXRfc2l6ZShuLGkpe3JldHVybiBlLmZkc1tuXSE9bnVsbD9lLmZkc1tuXS5mZF9maWxlc3RhdF9zZXRfc2l6ZShpKTo4fSxmZF9maWxlc3RhdF9zZXRfdGltZXMobixpLG8sYSl7cmV0dXJuIGUuZmRzW25dIT1udWxsP2UuZmRzW25dLmZkX2ZpbGVzdGF0X3NldF90aW1lcyhpLG8sYSk6OH0sZmRfcHJlYWQobixpLG8sYSxsKXtsZXQgZj1uZXcgRGF0YVZpZXcoZS5pbnN0LmV4cG9ydHMubWVtb3J5LmJ1ZmZlciksYz1uZXcgVWludDhBcnJheShlLmluc3QuZXhwb3J0cy5tZW1vcnkuYnVmZmVyKTtpZihlLmZkc1tuXSE9bnVsbCl7bGV0IGQ9eC5yZWFkX2J5dGVzX2FycmF5KGYsaSxvKSx7cmV0OmIsbnJlYWQ6cH09ZS5mZHNbbl0uZmRfcHJlYWQoYyxkLGEpO3JldHVybiBmLnNldFVpbnQzMihsLHAsITApLGJ9ZWxzZSByZXR1cm4gOH0sZmRfcHJlc3RhdF9nZXQobixpKXtsZXQgbz1uZXcgRGF0YVZpZXcoZS5pbnN0LmV4cG9ydHMubWVtb3J5LmJ1ZmZlcik7aWYoZS5mZHNbbl0hPW51bGwpe2xldHtyZXQ6YSxwcmVzdGF0Omx9PWUuZmRzW25dLmZkX3ByZXN0YXRfZ2V0KCk7cmV0dXJuIGw/LndyaXRlX2J5dGVzKG8saSksYX1lbHNlIHJldHVybiA4fSxmZF9wcmVzdGF0X2Rpcl9uYW1lKG4saSxvKXtpZihlLmZkc1tuXSE9bnVsbCl7bGV0e3JldDphLHByZXN0YXRfZGlyX25hbWU6bH09ZS5mZHNbbl0uZmRfcHJlc3RhdF9kaXJfbmFtZSgpO3JldHVybiBsIT1udWxsJiZuZXcgVWludDhBcnJheShlLmluc3QuZXhwb3J0cy5tZW1vcnkuYnVmZmVyKS5zZXQobCxpKSxhfWVsc2UgcmV0dXJuIDh9LGZkX3B3cml0ZShuLGksbyxhLGwpe2xldCBmPW5ldyBEYXRhVmlldyhlLmluc3QuZXhwb3J0cy5tZW1vcnkuYnVmZmVyKSxjPW5ldyBVaW50OEFycmF5KGUuaW5zdC5leHBvcnRzLm1lbW9yeS5idWZmZXIpO2lmKGUuZmRzW25dIT1udWxsKXtsZXQgZD1tLnJlYWRfYnl0ZXNfYXJyYXkoZixpLG8pLHtyZXQ6Yixud3JpdHRlbjpwfT1lLmZkc1tuXS5mZF9wd3JpdGUoYyxkLGEpO3JldHVybiBmLnNldFVpbnQzMihsLHAsITApLGJ9ZWxzZSByZXR1cm4gOH0sZmRfcmVhZChuLGksbyxhKXtsZXQgbD1uZXcgRGF0YVZpZXcoZS5pbnN0LmV4cG9ydHMubWVtb3J5LmJ1ZmZlciksZj1uZXcgVWludDhBcnJheShlLmluc3QuZXhwb3J0cy5tZW1vcnkuYnVmZmVyKTtpZihlLmZkc1tuXSE9bnVsbCl7bGV0IGM9eC5yZWFkX2J5dGVzX2FycmF5KGwsaSxvKSx7cmV0OmQsbnJlYWQ6Yn09ZS5mZHNbbl0uZmRfcmVhZChmLGMpO3JldHVybiBsLnNldFVpbnQzMihhLGIsITApLGR9ZWxzZSByZXR1cm4gOH0sZmRfcmVhZGRpcihuLGksbyxhLGwpe2xldCBmPW5ldyBEYXRhVmlldyhlLmluc3QuZXhwb3J0cy5tZW1vcnkuYnVmZmVyKSxjPW5ldyBVaW50OEFycmF5KGUuaW5zdC5leHBvcnRzLm1lbW9yeS5idWZmZXIpO2lmKGUuZmRzW25dIT1udWxsKXtsZXQgZD0wO2Zvcig7Oyl7bGV0e3JldDpiLGRpcmVudDpwfT1lLmZkc1tuXS5mZF9yZWFkZGlyX3NpbmdsZShhKTtpZihiIT0wKXJldHVybiBmLnNldFVpbnQzMihsLGQsITApLGI7aWYocD09bnVsbClicmVhaztpZihvLWQ8cC5oZWFkX2xlbmd0aCgpKXtkPW87YnJlYWt9bGV0IEU9bmV3IEFycmF5QnVmZmVyKHAuaGVhZF9sZW5ndGgoKSk7aWYocC53cml0ZV9oZWFkX2J5dGVzKG5ldyBEYXRhVmlldyhFKSwwKSxjLnNldChuZXcgVWludDhBcnJheShFKS5zbGljZSgwLE1hdGgubWluKEUuYnl0ZUxlbmd0aCxvLWQpKSxpKSxpKz1wLmhlYWRfbGVuZ3RoKCksZCs9cC5oZWFkX2xlbmd0aCgpLG8tZDxwLm5hbWVfbGVuZ3RoKCkpe2Q9bzticmVha31wLndyaXRlX25hbWVfYnl0ZXMoYyxpLG8tZCksaSs9cC5uYW1lX2xlbmd0aCgpLGQrPXAubmFtZV9sZW5ndGgoKSxhPXAuZF9uZXh0fXJldHVybiBmLnNldFVpbnQzMihsLGQsITApLDB9ZWxzZSByZXR1cm4gOH0sZmRfcmVudW1iZXIobixpKXtpZihlLmZkc1tuXSE9bnVsbCYmZS5mZHNbaV0hPW51bGwpe2xldCBvPWUuZmRzW2ldLmZkX2Nsb3NlKCk7cmV0dXJuIG8hPTA/bzooZS5mZHNbaV09ZS5mZHNbbl0sZS5mZHNbbl09dm9pZCAwLDApfWVsc2UgcmV0dXJuIDh9LGZkX3NlZWsobixpLG8sYSl7bGV0IGw9bmV3IERhdGFWaWV3KGUuaW5zdC5leHBvcnRzLm1lbW9yeS5idWZmZXIpO2lmKGUuZmRzW25dIT1udWxsKXtsZXR7cmV0OmYsb2Zmc2V0OmN9PWUuZmRzW25dLmZkX3NlZWsoaSxvKTtyZXR1cm4gbC5zZXRCaWdJbnQ2NChhLGMsITApLGZ9ZWxzZSByZXR1cm4gOH0sZmRfc3luYyhuKXtyZXR1cm4gZS5mZHNbbl0hPW51bGw/ZS5mZHNbbl0uZmRfc3luYygpOjh9LGZkX3RlbGwobixpKXtsZXQgbz1uZXcgRGF0YVZpZXcoZS5pbnN0LmV4cG9ydHMubWVtb3J5LmJ1ZmZlcik7aWYoZS5mZHNbbl0hPW51bGwpe2xldHtyZXQ6YSxvZmZzZXQ6bH09ZS5mZHNbbl0uZmRfdGVsbCgpO3JldHVybiBvLnNldEJpZ1VpbnQ2NChpLGwsITApLGF9ZWxzZSByZXR1cm4gOH0sZmRfd3JpdGUobixpLG8sYSl7bGV0IGw9bmV3IERhdGFWaWV3KGUuaW5zdC5leHBvcnRzLm1lbW9yeS5idWZmZXIpLGY9bmV3IFVpbnQ4QXJyYXkoZS5pbnN0LmV4cG9ydHMubWVtb3J5LmJ1ZmZlcik7aWYoZS5mZHNbbl0hPW51bGwpe2xldCBjPW0ucmVhZF9ieXRlc19hcnJheShsLGksbykse3JldDpkLG53cml0dGVuOmJ9PWUuZmRzW25dLmZkX3dyaXRlKGYsYyk7cmV0dXJuIGwuc2V0VWludDMyKGEsYiwhMCksZH1lbHNlIHJldHVybiA4fSxwYXRoX2NyZWF0ZV9kaXJlY3RvcnkobixpLG8pe2xldCBhPW5ldyBVaW50OEFycmF5KGUuaW5zdC5leHBvcnRzLm1lbW9yeS5idWZmZXIpO2lmKGUuZmRzW25dIT1udWxsKXtsZXQgbD1uZXcgVGV4dERlY29kZXIoInV0Zi04IikuZGVjb2RlKGEuc2xpY2UoaSxpK28pKTtyZXR1cm4gZS5mZHNbbl0ucGF0aF9jcmVhdGVfZGlyZWN0b3J5KGwpfX0scGF0aF9maWxlc3RhdF9nZXQobixpLG8sYSxsKXtsZXQgZj1uZXcgRGF0YVZpZXcoZS5pbnN0LmV4cG9ydHMubWVtb3J5LmJ1ZmZlciksYz1uZXcgVWludDhBcnJheShlLmluc3QuZXhwb3J0cy5tZW1vcnkuYnVmZmVyKTtpZihlLmZkc1tuXSE9bnVsbCl7bGV0IGQ9bmV3IFRleHREZWNvZGVyKCJ1dGYtOCIpLmRlY29kZShjLnNsaWNlKG8sbythKSkse3JldDpiLGZpbGVzdGF0OnB9PWUuZmRzW25dLnBhdGhfZmlsZXN0YXRfZ2V0KGksZCk7cmV0dXJuIHA/LndyaXRlX2J5dGVzKGYsbCksYn1lbHNlIHJldHVybiA4fSxwYXRoX2ZpbGVzdGF0X3NldF90aW1lcyhuLGksbyxhLGwsZixjKXtsZXQgZD1uZXcgVWludDhBcnJheShlLmluc3QuZXhwb3J0cy5tZW1vcnkuYnVmZmVyKTtpZihlLmZkc1tuXSE9bnVsbCl7bGV0IGI9bmV3IFRleHREZWNvZGVyKCJ1dGYtOCIpLmRlY29kZShkLnNsaWNlKG8sbythKSk7cmV0dXJuIGUuZmRzW25dLnBhdGhfZmlsZXN0YXRfc2V0X3RpbWVzKGksYixsLGYsYyl9ZWxzZSByZXR1cm4gOH0scGF0aF9saW5rKG4saSxvLGEsbCxmLGMpe2xldCBkPW5ldyBVaW50OEFycmF5KGUuaW5zdC5leHBvcnRzLm1lbW9yeS5idWZmZXIpO2lmKGUuZmRzW25dIT1udWxsJiZlLmZkc1tsXSE9bnVsbCl7bGV0IGI9bmV3IFRleHREZWNvZGVyKCJ1dGYtOCIpLmRlY29kZShkLnNsaWNlKG8sbythKSkscD1uZXcgVGV4dERlY29kZXIoInV0Zi04IikuZGVjb2RlKGQuc2xpY2UoZixmK2MpKTtyZXR1cm4gZS5mZHNbbF0ucGF0aF9saW5rKG4saSxiLHApfWVsc2UgcmV0dXJuIDh9LHBhdGhfb3BlbihuLGksbyxhLGwsZixjLGQsYil7bGV0IHA9bmV3IERhdGFWaWV3KGUuaW5zdC5leHBvcnRzLm1lbW9yeS5idWZmZXIpLEU9bmV3IFVpbnQ4QXJyYXkoZS5pbnN0LmV4cG9ydHMubWVtb3J5LmJ1ZmZlcik7aWYoZS5mZHNbbl0hPW51bGwpe2xldCBvdD1uZXcgVGV4dERlY29kZXIoInV0Zi04IikuZGVjb2RlKEUuc2xpY2UobyxvK2EpKSx7cmV0OiQsZmRfb2JqOmF0fT1lLmZkc1tuXS5wYXRoX29wZW4oaSxvdCxsLGYsYyxkKTtpZigkIT0wKXJldHVybiAkO2UuZmRzLnB1c2goYXQpO2xldCBsdD1lLmZkcy5sZW5ndGgtMTtyZXR1cm4gcC5zZXRVaW50MzIoYixsdCwhMCksMH1lbHNlIHJldHVybiA4fSxwYXRoX3JlYWRsaW5rKG4saSxvLGEsbCxmKXtsZXQgYz1uZXcgRGF0YVZpZXcoZS5pbnN0LmV4cG9ydHMubWVtb3J5LmJ1ZmZlciksZD1uZXcgVWludDhBcnJheShlLmluc3QuZXhwb3J0cy5tZW1vcnkuYnVmZmVyKTtpZihlLmZkc1tuXSE9bnVsbCl7bGV0IGI9bmV3IFRleHREZWNvZGVyKCJ1dGYtOCIpLmRlY29kZShkLnNsaWNlKGksaStvKSkse3JldDpwLGRhdGE6RX09ZS5mZHNbbl0ucGF0aF9yZWFkbGluayhiKTtpZihFIT1udWxsKXtpZihFLmxlbmd0aD5sKXJldHVybiBjLnNldFVpbnQzMihmLDAsITApLDg7ZC5zZXQoRSxhKSxjLnNldFVpbnQzMihmLEUubGVuZ3RoLCEwKX1yZXR1cm4gcH1lbHNlIHJldHVybiA4fSxwYXRoX3JlbW92ZV9kaXJlY3RvcnkobixpLG8pe2xldCBhPW5ldyBVaW50OEFycmF5KGUuaW5zdC5leHBvcnRzLm1lbW9yeS5idWZmZXIpO2lmKGUuZmRzW25dIT1udWxsKXtsZXQgbD1uZXcgVGV4dERlY29kZXIoInV0Zi04IikuZGVjb2RlKGEuc2xpY2UoaSxpK28pKTtyZXR1cm4gZS5mZHNbbl0ucGF0aF9yZW1vdmVfZGlyZWN0b3J5KGwpfWVsc2UgcmV0dXJuIDh9LHBhdGhfcmVuYW1lKG4saSxvLGEsbCxmKXt0aHJvdyJGSVhNRSB3aGF0IGlzIHRoZSBiZXN0IGFic3RyYWN0aW9uIGZvciB0aGlzPyJ9LHBhdGhfc3ltbGluayhuLGksbyxhLGwpe2xldCBmPW5ldyBVaW50OEFycmF5KGUuaW5zdC5leHBvcnRzLm1lbW9yeS5idWZmZXIpO2lmKGUuZmRzW29dIT1udWxsKXtsZXQgYz1uZXcgVGV4dERlY29kZXIoInV0Zi04IikuZGVjb2RlKGYuc2xpY2UobixuK2kpKSxkPW5ldyBUZXh0RGVjb2RlcigidXRmLTgiKS5kZWNvZGUoZi5zbGljZShhLGErbCkpO3JldHVybiBlLmZkc1tvXS5wYXRoX3N5bWxpbmsoYyxkKX1lbHNlIHJldHVybiA4fSxwYXRoX3VubGlua19maWxlKG4saSxvKXtsZXQgYT1uZXcgVWludDhBcnJheShlLmluc3QuZXhwb3J0cy5tZW1vcnkuYnVmZmVyKTtpZihlLmZkc1tuXSE9bnVsbCl7bGV0IGw9bmV3IFRleHREZWNvZGVyKCJ1dGYtOCIpLmRlY29kZShhLnNsaWNlKGksaStvKSk7cmV0dXJuIGUuZmRzW25dLnBhdGhfdW5saW5rX2ZpbGUobCl9ZWxzZSByZXR1cm4gOH0scG9sbF9vbmVvZmYobixpLG8pe3Rocm93ImFzeW5jIGlvIG5vdCBzdXBwb3J0ZWQifSxwcm9jX2V4aXQobil7dGhyb3ciZXhpdCB3aXRoIGV4aXQgY29kZSAiK259LHByb2NfcmFpc2Uobil7dGhyb3cicmFpc2VkIHNpZ25hbCAiK259LHNjaGVkX3lpZWxkKCl7fSxyYW5kb21fZ2V0KG4saSl7bGV0IG89bmV3IFVpbnQ4QXJyYXkoZS5pbnN0LmV4cG9ydHMubWVtb3J5LmJ1ZmZlcik7Zm9yKGxldCBhPTA7YTxpO2ErKylvW24rYV09TWF0aC5yYW5kb20oKSoyNTZ8MH0sc29ja19yZWN2KG4saSxvKXt0aHJvdyJzb2NrZXRzIG5vdCBzdXBwb3J0ZWQifSxzb2NrX3NlbmQobixpLG8pe3Rocm93InNvY2tldHMgbm90IHN1cHBvcnRlZCJ9LHNvY2tfc2h1dGRvd24obixpKXt0aHJvdyJzb2NrZXRzIG5vdCBzdXBwb3J0ZWQifX19fTt2YXIgTj1jbGFzc3tmZF9hZHZpc2UodCxyLHMpe3JldHVybi0xfWZkX2FsbG9jYXRlKHQscil7cmV0dXJuLTF9ZmRfY2xvc2UoKXtyZXR1cm4gMH1mZF9kYXRhc3luYygpe3JldHVybi0xfWZkX2Zkc3RhdF9nZXQoKXtyZXR1cm57cmV0Oi0xLGZkc3RhdDpudWxsfX1mZF9mZHN0YXRfc2V0X2ZsYWdzKHQpe3JldHVybi0xfWZkX2Zkc3RhdF9zZXRfcmlnaHRzKHQscil7cmV0dXJuLTF9ZmRfZmlsZXN0YXRfZ2V0KCl7cmV0dXJue3JldDotMSxmaWxlc3RhdDpudWxsfX1mZF9maWxlc3RhdF9zZXRfc2l6ZSh0KXtyZXR1cm4tMX1mZF9maWxlc3RhdF9zZXRfdGltZXModCxyLHMpe3JldHVybi0xfWZkX3ByZWFkKHQscixzKXtyZXR1cm57cmV0Oi0xLG5yZWFkOjB9fWZkX3ByZXN0YXRfZ2V0KCl7cmV0dXJue3JldDotMSxwcmVzdGF0Om51bGx9fWZkX3ByZXN0YXRfZGlyX25hbWUodCxyKXtyZXR1cm57cmV0Oi0xLHByZXN0YXRfZGlyX25hbWU6bnVsbH19ZmRfcHdyaXRlKHQscixzKXtyZXR1cm57cmV0Oi0xLG53cml0dGVuOjB9fWZkX3JlYWQodCxyKXtyZXR1cm57cmV0Oi0xLG5yZWFkOjB9fWZkX3JlYWRkaXJfc2luZ2xlKHQpe3JldHVybntyZXQ6LTEsZGlyZW50Om51bGx9fWZkX3NlZWsodCxyKXtyZXR1cm57cmV0Oi0xLG9mZnNldDowbn19ZmRfc3luYygpe3JldHVybiAwfWZkX3RlbGwoKXtyZXR1cm57cmV0Oi0xLG9mZnNldDowbn19ZmRfd3JpdGUodCxyKXtyZXR1cm57cmV0Oi0xLG53cml0dGVuOjB9fXBhdGhfY3JlYXRlX2RpcmVjdG9yeSh0KXtyZXR1cm4tMX1wYXRoX2ZpbGVzdGF0X2dldCh0LHIpe3JldHVybntyZXQ6LTEsZmlsZXN0YXQ6bnVsbH19cGF0aF9maWxlc3RhdF9zZXRfdGltZXModCxyLHMsZSxuKXtyZXR1cm4tMX1wYXRoX2xpbmsodCxyLHMsZSl7cmV0dXJuLTF9cGF0aF9vcGVuKHQscixzLGUsbixpKXtyZXR1cm57cmV0Oi0xLGZkX29iajpudWxsfX1wYXRoX3JlYWRsaW5rKHQpe3JldHVybntyZXQ6LTEsZGF0YTpudWxsfX1wYXRoX3JlbW92ZV9kaXJlY3RvcnkodCl7cmV0dXJuLTF9cGF0aF9yZW5hbWUodCxyLHMpe3JldHVybi0xfXBhdGhfc3ltbGluayh0LHIpe3JldHVybi0xfXBhdGhfdW5saW5rX2ZpbGUodCl7cmV0dXJuLTF9fTt2YXIgUj1jbGFzc3tnZXQgc2l6ZSgpe3JldHVybiBCaWdJbnQodGhpcy5kYXRhLmJ5dGVMZW5ndGgpfXN0YXQoKXtyZXR1cm4gbmV3IFUoQix0aGlzLnNpemUpfXRydW5jYXRlKCl7dGhpcy5kYXRhPW5ldyBVaW50OEFycmF5KFtdKX1jb25zdHJ1Y3Rvcih0KXt0aGlzLmRhdGE9bmV3IFVpbnQ4QXJyYXkodCl9fTt2YXIgeT1jbGFzcyBleHRlbmRzIE57ZmRfZmRzdGF0X2dldCgpe3JldHVybntyZXQ6MCxmZHN0YXQ6bmV3IGsoQiwwKX19ZmRfcmVhZCh0LHIpe2xldCBzPTA7Zm9yKGxldCBlIG9mIHIpaWYodGhpcy5maWxlX3Bvczx0aGlzLmZpbGUuZGF0YS5ieXRlTGVuZ3RoKXtsZXQgbj10aGlzLmZpbGUuZGF0YS5zbGljZShOdW1iZXIodGhpcy5maWxlX3BvcyksTnVtYmVyKHRoaXMuZmlsZV9wb3MrQmlnSW50KGUuYnVmX2xlbikpKTt0LnNldChuLGUuYnVmKSx0aGlzLmZpbGVfcG9zKz1CaWdJbnQobi5sZW5ndGgpLHMrPW4ubGVuZ3RofWVsc2UgYnJlYWs7cmV0dXJue3JldDowLG5yZWFkOnN9fWZkX3NlZWsodCxyKXtsZXQgcztzd2l0Y2gocil7Y2FzZSB0dDpzPXQ7YnJlYWs7Y2FzZSBldDpzPXRoaXMuZmlsZV9wb3MrdDticmVhaztjYXNlIHJ0OnM9QmlnSW50KHRoaXMuZmlsZS5kYXRhLmJ5dGVMZW5ndGgpK3Q7YnJlYWs7ZGVmYXVsdDpyZXR1cm57cmV0OjI4LG9mZnNldDowbn19cmV0dXJuIHM8MD97cmV0OjI4LG9mZnNldDowbn06KHRoaXMuZmlsZV9wb3M9cyx7cmV0OjAsb2Zmc2V0OnRoaXMuZmlsZV9wb3N9KX1mZF93cml0ZSh0LHIpe2xldCBzPTA7Zm9yKGxldCBlIG9mIHIpe2xldCBuPXQuc2xpY2UoZS5idWYsZS5idWYrZS5idWZfbGVuKTtpZih0aGlzLmZpbGVfcG9zK0JpZ0ludChuLmJ5dGVMZW5ndGgpPnRoaXMuZmlsZS5zaXplKXtsZXQgaT10aGlzLmZpbGUuZGF0YTt0aGlzLmZpbGUuZGF0YT1uZXcgVWludDhBcnJheShOdW1iZXIodGhpcy5maWxlX3BvcytCaWdJbnQobi5ieXRlTGVuZ3RoKSkpLHRoaXMuZmlsZS5kYXRhLnNldChpKX10aGlzLmZpbGUuZGF0YS5zZXQobi5zbGljZSgwLE51bWJlcih0aGlzLmZpbGUuc2l6ZS10aGlzLmZpbGVfcG9zKSksTnVtYmVyKHRoaXMuZmlsZV9wb3MpKSx0aGlzLmZpbGVfcG9zKz1CaWdJbnQobi5ieXRlTGVuZ3RoKSxzKz1lLmJ1Zl9sZW59cmV0dXJue3JldDowLG53cml0dGVuOnN9fWZkX2ZpbGVzdGF0X2dldCgpe3JldHVybntyZXQ6MCxmaWxlc3RhdDp0aGlzLmZpbGUuc3RhdCgpfX1jb25zdHJ1Y3Rvcih0KXtzdXBlcigpLHRoaXMuZmlsZV9wb3M9MG4sdGhpcy5maWxlPXR9fTthc3luYyBmdW5jdGlvbiBzdCh1KXtsZXQgdD1bXSxyPVtdLHM9W25ldyB5KG5ldyBSKFtdKSksbmV3IHkobmV3IFIoW10pKSxuZXcgeShuZXcgUihbXSkpXSxlPW5ldyB6KHQscixzKTtyZXR1cm57YXN5bmMgaW1wb3J0T2JqZWN0KCl7cmV0dXJuIGUud2FzaUltcG9ydH0sYXN5bmMgaW5pdGlhbGl6ZShuKXtsZXQgaT1uLmV4cG9ydHMubWVtb3J5O2lmKCFpKXRocm93IG5ldyBFcnJvcigiVGhlIG1vZHVsZSBoYXMgdG8gZXhwb3J0IGEgZGVmYXVsdCBtZW1vcnkuIik7aWYobi5leHBvcnRzLl9pbml0aWFsaXplKXtsZXQgbz1uLmV4cG9ydHMuX2luaXRpYWxpemU7ZS5pbml0aWFsaXplP2UuaW5pdGlhbGl6ZSh7ZXhwb3J0czp7bWVtb3J5OmksX2luaXRpYWxpemU6KCk9PntvKCl9fX0pOm8oKX1lbHNlIG4uZXhwb3J0cy5fc3RhcnQmJmUuc3RhcnQoe2V4cG9ydHM6e21lbW9yeTppLF9zdGFydDooKT0+e319fSl9fX12YXIgeHQ9ImV4dGlzbTpob3N0L2VudiIsWD1jbGFzc3sjZTsjdDsjcjsjbj0hMTtjb25zdHJ1Y3Rvcih0LHIscyl7dGhpcy4jZT10LHRoaXMuI3I9cix0aGlzLiN0PXN9YXN5bmMgcmVzZXQoKXtyZXR1cm4gdGhpcy5pc0FjdGl2ZSgpPyExOih0aGlzLiNlW1ldKCksITApfWlzQWN0aXZlKCl7cmV0dXJuIHRoaXMuI259YXN5bmMgZnVuY3Rpb25FeGlzdHModCl7dHJ5e2xldCByPVtdLmNvbmNhdCh0KSxbcyxlXT1yLmxlbmd0aD09PTI/W3RoaXMubG9va3VwVGFyZ2V0KHJbMF0pLHJbMV1dOlt0aGlzLiN0LmZpbmQoaT0+V2ViQXNzZW1ibHkuTW9kdWxlLmV4cG9ydHMoaS5tb2R1bGUpLmZpbmQoYT0+YS5uYW1lPT09clswXSYmYS5raW5kPT09ImZ1bmN0aW9uIikpLHJbMF1dO3JldHVybiEoIXN8fCFzLmluc3RhbmNlLmV4cG9ydHNbZV0pfWNhdGNoe3JldHVybiExfX1hc3luYyBjYWxsQmxvY2sodCxyKXt0aGlzLiNuPSEwO2xldCBzPVtdLmNvbmNhdCh0KSxbZSxuXT1zLmxlbmd0aD09PTI/W3RoaXMubG9va3VwVGFyZ2V0KHNbMF0pLHNbMV1dOlt0aGlzLiN0LmZpbmQobz0+V2ViQXNzZW1ibHkuTW9kdWxlLmV4cG9ydHMoby5tb2R1bGUpLmZpbmQobD0+bC5uYW1lPT09c1swXSYmbC5raW5kPT09ImZ1bmN0aW9uIikpLHNbMF1dO2lmKCFlKXRocm93IEVycm9yKGBQbHVnaW4gZXJyb3I6IHRhcmdldCAiJHtzLmpvaW4oJyIgIicpfSIgZG9lcyBub3QgZXhpc3RgKTtsZXQgaT1lLmluc3RhbmNlLmV4cG9ydHNbbl07aWYoIWkpdGhyb3cgRXJyb3IoYFBsdWdpbiBlcnJvcjogZnVuY3Rpb24gIiR7cy5qb2luKCciICInKX0iIGRvZXMgbm90IGV4aXN0YCk7dGhpcy4jZVt2XShyPz9udWxsKTt0cnl7cmV0dXJuIGkoKSx0aGlzLiNlW0xdKCl9Y2F0Y2gobyl7dGhyb3cgdGhpcy4jZVtMXSgpLG99ZmluYWxseXt0aGlzLiNuPSExfX1hc3luYyBjYWxsKHQscil7bGV0IHM9dGhpcy4jZVtUXShyKSxbZSxuXT1hd2FpdCB0aGlzLmNhbGxCbG9jayh0LHMpLGk9ZSE9PW51bGwsbz1lPz9uO2lmKG89PT1udWxsKXJldHVybiBudWxsO2xldCBhPXRoaXMuI2VbVl0obyk7aWYoIWEpcmV0dXJuIG51bGw7bGV0IGw9bmV3IHcoYS5idWZmZXIpO2lmKGkpdGhyb3cgbmV3IEVycm9yKGBQbHVnaW4tb3JpZ2luYXRlZCBlcnJvcjogJHtsLnN0cmluZygpfWApO3JldHVybiBsfWxvb2t1cFRhcmdldCh0KXtsZXQgcj1TdHJpbmcodD8/IjAiKSxzPXRoaXMuI3IuZmluZEluZGV4KGU9PmU9PT1yKTtpZihzPT09LTEpdGhyb3cgbmV3IEVycm9yKGBubyBtb2R1bGUgbmFtZWQgIiR7dH0iYCk7cmV0dXJuIHRoaXMuI3Rbc119YXN5bmMgZ2V0RXhwb3J0cyh0KXtyZXR1cm4gV2ViQXNzZW1ibHkuTW9kdWxlLmV4cG9ydHModGhpcy5sb29rdXBUYXJnZXQodCkubW9kdWxlKXx8W119YXN5bmMgZ2V0SW1wb3J0cyh0KXtyZXR1cm4gV2ViQXNzZW1ibHkuTW9kdWxlLmltcG9ydHModGhpcy5sb29rdXBUYXJnZXQodCkubW9kdWxlKXx8W119YXN5bmMgZ2V0SW5zdGFuY2UodCl7cmV0dXJuIHRoaXMubG9va3VwVGFyZ2V0KHQpLmluc3RhbmNlfWFzeW5jIGNsb3NlKCl7fX07YXN5bmMgZnVuY3Rpb24gaXQodSx0LHIscz1uZXcgQShBcnJheUJ1ZmZlcix1LmxvZ2dlcix1LmNvbmZpZykpe2xldCBlPXUud2FzaUVuYWJsZWQ/YXdhaXQgc3QodS5hbGxvd2VkUGF0aHMpOm51bGwsbj17Li4uZT97d2FzaV9zbmFwc2hvdF9wcmV2aWV3MTphd2FpdCBlLmltcG9ydE9iamVjdCgpfTp7fSxbeHRdOnNbV10sZW52Ont9fTtmb3IobGV0IG8gaW4gdS5mdW5jdGlvbnMpe25bb109bltvXXx8e307Zm9yKGxldCBhIGluIHUuZnVuY3Rpb25zW29dKW5bb11bYV09dS5mdW5jdGlvbnNbb11bYV0uYmluZChudWxsLHMpfWxldCBpPWF3YWl0IFByb21pc2UuYWxsKHIubWFwKGFzeW5jIG89PntsZXQgYT1hd2FpdCBXZWJBc3NlbWJseS5pbnN0YW50aWF0ZShvLG4pO2UmJmF3YWl0IGU/LmluaXRpYWxpemUoYSk7bGV0IGw9YS5leHBvcnRzLmhzX2luaXQ/Imhhc2tlbGwiOmEuZXhwb3J0cy5faW5pdGlhbGl6ZT8icmVhY3RvciI6YS5leHBvcnRzLl9zdGFydD8iY29tbWFuZCI6Im5vbmUiO3JldHVybihhLmV4cG9ydHMuaHNfaW5pdD9hLmV4cG9ydHMuaHNfaW5pdDooKT0+e30pKCkse21vZHVsZTpvLGluc3RhbmNlOmEsZ3Vlc3RUeXBlOmx9fSkpO3JldHVybiBuZXcgWChzLHQsaSl9dmFyIFA9NWUzLGo9Y2xhc3N7aG9zdEZsYWc7c2hhcmVkRGF0YTtzaGFyZWREYXRhVmlldztwbHVnaW47cG9ydDtkeW5hbWljSGFuZGxlcnM7Y29udGV4dDtjb25zdHJ1Y3Rvcih0KXtpZighdCl0aHJvdyBuZXcgRXJyb3IoIlRoaXMgc2hvdWxkIGJlIHVucmVhY2hhYmxlOiB0aGlzIG1vZHVsZSBzaG91bGQgb25seSBiZSBpbnZva2VkIGFzIGEgd2ViIHdvcmtlci4iKTt0aGlzLnNoYXJlZERhdGE9bnVsbCx0aGlzLnNoYXJlZERhdGFWaWV3PW51bGwsdGhpcy5ob3N0RmxhZz1udWxsLHRoaXMucG9ydD10LHRoaXMucG9ydC5vbigibWVzc2FnZSIscj0+dGhpcy5oYW5kbGVNZXNzYWdlKHIpKSx0aGlzLnBvcnQucG9zdE1lc3NhZ2Uoe3R5cGU6ImluaXRpYWxpemVkIn0pLHRoaXMuZHluYW1pY0hhbmRsZXJzPW5ldyBNYXAsdGhpcy5keW5hbWljSGFuZGxlcnMuc2V0KCJjYWxsIixhc3luYyhyLHMsZSxuKT0+e2lmKCF0aGlzLmNvbnRleHQpdGhyb3cgbmV3IEVycm9yKCJpbnZhbGlkIHN0YXRlOiBubyBjb250ZXh0IGF2YWlsYWJsZSB0byB3b3JrZXIgcmVhY3RvciIpO3RoaXMuY29udGV4dFtDXShuKTtsZXQgaT1hd2FpdCB0aGlzLnBsdWdpbj8uY2FsbEJsb2NrKHMsZSkudGhlbihvPT5bbnVsbCxvXSxvPT5bbyxudWxsXSk7bj10aGlzLmNvbnRleHRbRl0oKTtmb3IobGV0W29db2Ygbi5ibG9ja3MpbyYmci5wdXNoKG8pO3JldHVybiBpWzBdJiYoaVswXT17b3JpZ2luYWxTdGFjazppWzBdPy5zdGFjayxtZXNzYWdlOmlbMF0/Lm1lc3NhZ2V9KSx7cmVzdWx0czppLHN0YXRlOm59fSksdGhpcy5keW5hbWljSGFuZGxlcnMuc2V0KCJyZXNldCIsYXN5bmMgcj0+dGhpcy5wbHVnaW4/LnJlc2V0KCkpLHRoaXMuZHluYW1pY0hhbmRsZXJzLnNldCgiZ2V0RXhwb3J0cyIsYXN5bmMocixzKT0+dGhpcy5wbHVnaW4/LmdldEV4cG9ydHMocykpLHRoaXMuZHluYW1pY0hhbmRsZXJzLnNldCgiZ2V0SW1wb3J0cyIsYXN5bmMocixzKT0+dGhpcy5wbHVnaW4/LmdldEltcG9ydHMocykpLHRoaXMuZHluYW1pY0hhbmRsZXJzLnNldCgiZnVuY3Rpb25FeGlzdHMiLGFzeW5jKHIscyk9PnRoaXMucGx1Z2luPy5mdW5jdGlvbkV4aXN0cyhzKSl9YXN5bmMgaGFuZGxlTWVzc2FnZSh0KXtzd2l0Y2godC50eXBlKXtjYXNlImluaXQiOnJldHVybiBhd2FpdCB0aGlzLmhhbmRsZUluaXQodCk7Y2FzZSJpbnZva2UiOnJldHVybiBhd2FpdCB0aGlzLmhhbmRsZUludm9rZSh0KX19YXN5bmMgaGFuZGxlSW52b2tlKHQpe2xldCByPXRoaXMuZHluYW1pY0hhbmRsZXJzLmdldCh0LmhhbmRsZXIpO2lmKCFyKXJldHVybiB0aGlzLnBvcnQucG9zdE1lc3NhZ2Uoe3R5cGU6InJldHVybiIscmVzdWx0Oltgbm8gaGFuZGxlciByZWdpc3RlcmVkIGZvciAke3QuaGFuZGxlcn1gLG51bGxdfSk7bGV0IHM9W10sZT1hd2FpdCByKHMsLi4udC5hcmdzfHxbXSkudGhlbihuPT5bbnVsbCxuXSxuPT5bbixudWxsXSk7cmV0dXJuIGVbMF0mJihlWzBdPXtvcmlnaW5hbFN0YWNrOmVbMF0/LnN0YWNrLG1lc3NhZ2U6ZVswXT8ubWVzc2FnZX0pLHRoaXMucG9ydC5wb3N0TWVzc2FnZSh7dHlwZToicmV0dXJuIixyZXN1bHRzOmV9LHMpfWFzeW5jIGhhbmRsZUluaXQodCl7dGhpcy5zaGFyZWREYXRhPXQuc2hhcmVkRGF0YSx0aGlzLnNoYXJlZERhdGFWaWV3PW5ldyBEYXRhVmlldyh0LnNoYXJlZERhdGEpLHRoaXMuaG9zdEZsYWc9bmV3IEludDMyQXJyYXkodGhpcy5zaGFyZWREYXRhKTtsZXQgcj1PYmplY3QuZnJvbUVudHJpZXMoT2JqZWN0LmVudHJpZXModC5mdW5jdGlvbnMpLm1hcCgoW2wsZl0pPT5bbCxPYmplY3QuZnJvbUVudHJpZXMoZi5tYXAoYz0+W2MsKGQsLi4uYik9PnRoaXMuY2FsbEhvc3QoZCxsLGMsYildKSldKSkse3R5cGU6cyxtb2R1bGVzOmUsZnVuY3Rpb25zOm4sLi4uaX09dCxvPWw9PmY9PnRoaXMucG9ydC5wb3N0TWVzc2FnZSh7dHlwZToibG9nIixsZXZlbDpsLG1lc3NhZ2U6Zn0pLGE9T2JqZWN0LmZyb21FbnRyaWVzKFsiaW5mbyIsImRlYnVnIiwid2FybiIsImVycm9yIl0ubWFwKGw9PltsLG8obCldKSk7dGhpcy5jb250ZXh0PW5ldyBBKEFycmF5QnVmZmVyLGEsdC5jb25maWcpLHRoaXMucGx1Z2luPWF3YWl0IGl0KHsuLi5pLGZ1bmN0aW9uczpyLGZldGNoLGxvZ2dlcjphfSx0Lm5hbWVzLGUsdGhpcy5jb250ZXh0KSx0aGlzLnBvcnQucG9zdE1lc3NhZ2Uoe3R5cGU6InJlYWR5In0pfWNhbGxIb3N0KHQscixzLGUpe2lmKCF0aGlzLmhvc3RGbGFnKXRocm93IG5ldyBFcnJvcigiYXR0ZW1wdGVkIHRvIGNhbGwgaG9zdCBiZWZvcmUgcmVjZWl2aW5nIHNoYXJlZCBhcnJheSBidWZmZXIiKTtsZXQgbj10W0ZdKCk7dGhpcy5wb3J0LnBvc3RNZXNzYWdlKHt0eXBlOiJpbnZva2UiLG5hbWVzcGFjZTpyLGZ1bmM6cyxhcmdzOmUsc3RhdGU6bn0pO2xldCBpPW5ldyBJKHRoaXMuc2hhcmVkRGF0YSksbz1bXSxhO2Rve2xldCBsPWkucmVhZFVpbnQ4KCk7c3dpdGNoKGwpe2Nhc2UgMDpyZXR1cm4gbi5ibG9ja3M9byx0W0NdKG4pLGkuY2xvc2UoKSx0aGlzLmhvc3RGbGFnWzBdPUkuU0FCX0JBU0VfT0ZGU0VULGE7Y2FzZSAxOmE9aS5yZWFkVWludDY0KCk7YnJlYWs7Y2FzZSAyOmE9aS5yZWFkRmxvYXQ2NCgpO2JyZWFrO2Nhc2UgMzphPXZvaWQgMDticmVhaztjYXNlIDQ6e2xldCBmPWkucmVhZFVpbnQzMigpLGM9aS5yZWFkVWludDMyKCk7aWYoIWMpby5wdXNoKFtudWxsLGZdKTtlbHNle2xldCBkPW5ldyBVaW50OEFycmF5KGMpO2kucmVhZChkKSxvLnB1c2goW2QuYnVmZmVyLGZdKX19YnJlYWs7ZGVmYXVsdDp0aHJvdyBuZXcgRXJyb3IoYGludmFsaWQgc2VjdGlvbiB0eXBlPSIke2x9IjsgcGxlYXNlIG9wZW4gYW4gaXNzdWUgKGh0dHBzOi8vZ2l0aHViLmNvbS9leHRpc20vanMtc2RrL2lzc3Vlcy9uZXc/dGl0bGU9c2hhcmVkK2FycmF5K2J1ZmZlcitiYWQrc2VjdGlvbit0eXBlKyR7bH0mbGFiZWxzPWJ1ZylgKX19d2hpbGUoMSl9fTtuZXcgaihxKTt2YXIgZz1jbGFzc3tpbnB1dDtmbGFnO2lucHV0T2Zmc2V0O3NjcmF0Y2g7c2NyYXRjaFZpZXc7ZXhwZWN0ZWQ7Y29uc3RydWN0b3IodCl7dGhpcy5pbnB1dD10LHRoaXMuaW5wdXRPZmZzZXQ9Zy5TQUJfQkFTRV9PRkZTRVQsdGhpcy5mbGFnPW5ldyBJbnQzMkFycmF5KHRoaXMuaW5wdXQpLHRoaXMuc2NyYXRjaD1uZXcgQXJyYXlCdWZmZXIoOCksdGhpcy5zY3JhdGNoVmlldz1uZXcgRGF0YVZpZXcodGhpcy5zY3JhdGNoKSx0aGlzLmV4cGVjdGVkPTAsdGhpcy5wdWxsKCExKX1nZXQgYXZhaWxhYmxlKCl7cmV0dXJuIHRoaXMuZmxhZ1swXS10aGlzLmlucHV0T2Zmc2V0fWNsb3NlKCl7Zm9yKDtBdG9taWNzLmNvbXBhcmVFeGNoYW5nZSh0aGlzLmZsYWcsZy5TQUJfSURYLHRoaXMuZXhwZWN0ZWQsZy5TQUJfQkFTRV9PRkZTRVQpIT09Zy5TQUJfQkFTRV9PRkZTRVQ7KTtBdG9taWNzLm5vdGlmeSh0aGlzLmZsYWcsZy5TQUJfSURYLFApfXB1bGwodD0hMCl7aWYodCl7Zm9yKDtBdG9taWNzLmNvbXBhcmVFeGNoYW5nZSh0aGlzLmZsYWcsZy5TQUJfSURYLHRoaXMuZXhwZWN0ZWQsZy5TQUJfQkFTRV9PRkZTRVQpIT09Zy5TQUJfQkFTRV9PRkZTRVQ7KTtBdG9taWNzLm5vdGlmeSh0aGlzLmZsYWcsZy5TQUJfSURYLFApfWxldCByPUF0b21pY3Mud2FpdCh0aGlzLmZsYWcsMCxnLlNBQl9CQVNFX09GRlNFVCxQKTtpZih0aGlzLmV4cGVjdGVkPUF0b21pY3MubG9hZCh0aGlzLmZsYWcsMCkscj09PSJ0aW1lZC1vdXQiKXRocm93IG5ldyBFcnJvcihgV29ya2VyIHRpbWVkIG91dCB3YWl0aW5nIGZvciByZXNwb25zZSBmcm9tIGhvc3QgYWZ0ZXIgJHtQfW1zICR7dGhpcy5mbGFnWzBdfWApO3RoaXMuaW5wdXRPZmZzZXQ9Zy5TQUJfQkFTRV9PRkZTRVR9cmVhZCh0KXtpZih0LmJ5dGVMZW5ndGg8dGhpcy5hdmFpbGFibGUpe3Quc2V0KG5ldyBVaW50OEFycmF5KHRoaXMuaW5wdXQpLnN1YmFycmF5KHRoaXMuaW5wdXRPZmZzZXQsdGhpcy5pbnB1dE9mZnNldCt0LmJ5dGVMZW5ndGgpKSx0aGlzLmlucHV0T2Zmc2V0Kz10LmJ5dGVMZW5ndGg7cmV0dXJufWxldCByPTAscz10aGlzLmF2YWlsYWJsZTtkb3tpZih0LnNldChuZXcgVWludDhBcnJheSh0aGlzLmlucHV0KS5zdWJhcnJheSh0aGlzLmlucHV0T2Zmc2V0LHRoaXMuaW5wdXRPZmZzZXQrcykscikscis9cyx0aGlzLmlucHV0T2Zmc2V0Kz1zLHI9PT10LmJ5dGVMZW5ndGh8fHRoaXMuYXZhaWxhYmxlPDApYnJlYWs7dGhpcy5wdWxsKCkscz1NYXRoLm1pbihNYXRoLm1heCh0aGlzLmF2YWlsYWJsZSwwKSx0LmJ5dGVMZW5ndGgtcil9d2hpbGUociE9PXQuYnl0ZUxlbmd0aCl9cmVhZFVpbnQ4KCl7cmV0dXJuIHRoaXMucmVhZChuZXcgVWludDhBcnJheSh0aGlzLnNjcmF0Y2gpLnN1YmFycmF5KDAsMSkpLHRoaXMuc2NyYXRjaFZpZXcuZ2V0VWludDgoMCl9cmVhZFVpbnQzMigpe3JldHVybiB0aGlzLnJlYWQobmV3IFVpbnQ4QXJyYXkodGhpcy5zY3JhdGNoKS5zdWJhcnJheSgwLDQpKSx0aGlzLnNjcmF0Y2hWaWV3LmdldFVpbnQzMigwLCEwKX1yZWFkVWludDY0KCl7cmV0dXJuIHRoaXMucmVhZChuZXcgVWludDhBcnJheSh0aGlzLnNjcmF0Y2gpKSx0aGlzLnNjcmF0Y2hWaWV3LmdldEJpZ1VpbnQ2NCgwLCEwKX1yZWFkRmxvYXQ2NCgpe3JldHVybiB0aGlzLnJlYWQobmV3IFVpbnQ4QXJyYXkodGhpcy5zY3JhdGNoKSksdGhpcy5zY3JhdGNoVmlldy5nZXRGbG9hdDY0KDAsITApfX0sST1nO0coSSwiU0FCX0lEWCIsMCksRyhJLCJTQUJfQkFTRV9PRkZTRVQiLDQpOwovLyMgc291cmNlTWFwcGluZ1VSTD13b3JrZXIuanMubWFwCg=="),ut=new WeakMap,mt=class extends(globalThis.Worker||Object){constructor(t){super(t,{type:"module",credentials:"omit",name:"extism-worker",crossOriginIsolated:!0})}on(t,e){let s=t=>e(t.data);ut.set(e,s),this.addEventListener(t,s)}removeListener(t,e){let s=ut.get(e);s&&this.removeEventListener(t,s)}once(t,e){let s=this;this.addEventListener(t,(function l(...i){s.removeEventListener(t,l),e.call(s,...i)}))}},pt=(1,E=null!=(U=p())?t(i(U)):{},((t,i,r,a)=>{if(i&&"object"==typeof i||"function"==typeof i)for(let r of l(i))!n.call(t,r)&&undefined!==r&&e(t,r,{get:()=>i[r],enumerable:!(a=s(i,r))||a.enumerable});return t})(e(E,"default",{value:U,enumerable:!0}),U)),bt=t=>{if("string"!=typeof t)throw new TypeError("invalid pattern");if(t.length>65536)throw new TypeError("pattern is too long")},Zt={"[:alnum:]":["\\p{L}\\p{Nl}\\p{Nd}",!0],"[:alpha:]":["\\p{L}\\p{Nl}",!0],"[:ascii:]":["\\x00-\\x7f",!1],"[:blank:]":["\\p{Zs}\\t",!0],"[:cntrl:]":["\\p{Cc}",!0],"[:digit:]":["\\p{Nd}",!0],"[:graph:]":["\\p{Z}\\p{C}",!0,!0],"[:lower:]":["\\p{Ll}",!0],"[:print:]":["\\p{C}",!0],"[:punct:]":["\\p{P}",!0],"[:space:]":["\\p{Z}\\t\\r\\n\\v\\f",!0],"[:upper:]":["\\p{Lu}",!0],"[:word:]":["\\p{L}\\p{Nl}\\p{Nd}\\p{Pc}",!0],"[:xdigit:]":["A-Fa-f0-9",!1]},ft=t=>t.replace(/[[\]\\-]/g,"\\$&"),yt=t=>t.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&"),Xt=t=>t.join(""),Gt=(t,e)=>{let s=e;if("["!==t.charAt(s))throw new Error("not in a brace expression");let l=[],i=[],n=s+1,r=!1,a=!1,d=!1,h=!1,c=s,o="";t:for(;n<t.length;){let e=t.charAt(n);if("!"!==e&&"^"!==e||n!==s+1){if("]"===e&&r&&!d){c=n+1;break}if(r=!0,"\\"!==e||d){if("["===e&&!d)for(let[e,[r,d,h]]of Object.entries(Zt))if(t.startsWith(e,n)){if(o)return["$.",!1,t.length-s,!0];n+=e.length,h?i.push(r):l.push(r),a=a||d;continue t}d=!1,o?(e>o?l.push(ft(o)+"-"+ft(e)):e===o&&l.push(ft(e)),o="",n++):t.startsWith("-]",n+1)?(l.push(ft(e+"-")),n+=2):t.startsWith("-",n+1)?(o=e,n+=2):(l.push(ft(e)),n++)}else d=!0,n++}else h=!0,n++}if(c<n)return["",!1,0,!1];if(!l.length&&!i.length)return["$.",!1,t.length-s,!0];if(0===i.length&&1===l.length&&/^\\?.$/.test(l[0])&&!h){let t=2===l[0].length?l[0].slice(-1):l[0];return[yt(t),!1,c-s,!1]}let u="["+(h?"^":"")+Xt(l)+"]",m="["+(h?"":"^")+Xt(i)+"]";return[l.length&&i.length?"("+u+"|"+m+")":l.length?u:m,a,c-s,!0]},Vt=(t,{windowsPathsNoEscape:e=!1}={})=>e?t.replace(/\[([^\/\\])\]/g,"$1"):t.replace(/((?!\\).|^)\[([^\/\\])\]/g,"$1$2").replace(/\\([^\/])/g,"$1"),Wt=new Set(["!","?","+","*","@"]),gt=t=>Wt.has(t),wt="(?!\\.)",xt=new Set(["[","."]),Rt=new Set(["..","."]),Lt=new Set("().*{}+?[]^$\\!"),It=t=>t.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&"),Ht="[^/]",zt=Ht+"*?",Yt=Ht+"+?",St=class{constructor(t,e,s={}){c(this,lt),c(this,at),a(this,"type"),c(this,_,void 0),c(this,P,void 0),c(this,j,!1),c(this,O,[]),c(this,A,void 0),c(this,D,void 0),c(this,$,void 0),c(this,q,!1),c(this,tt,void 0),c(this,et,void 0),c(this,st,!1),this.type=t,t&&o(this,P,!0),o(this,A,e),o(this,_,h(this,A)?h(h(this,A),_):this),o(this,tt,h(this,_)===this?s:h(h(this,_),tt)),o(this,$,h(this,_)===this?[]:h(h(this,_),$)),"!"===t&&!h(h(this,_),q)&&h(this,$).push(this),o(this,D,h(this,A)?h(h(this,A),O).length:0)}get hasMagic(){if(void 0!==h(this,P))return h(this,P);for(let t of h(this,O))if("string"!=typeof t&&(t.type||t.hasMagic))return o(this,P,!0);return h(this,P)}toString(){return void 0!==h(this,et)?h(this,et):this.type?o(this,et,this.type+"("+h(this,O).map((t=>String(t))).join("|")+")"):o(this,et,h(this,O).map((t=>String(t))).join(""))}push(...t){for(let e of t)if(""!==e){if("string"!=typeof e&&!(e instanceof St&&h(e,A)===this))throw new Error("invalid part: "+e);h(this,O).push(e)}}toJSON(){let t=null===this.type?h(this,O).slice().map((t=>"string"==typeof t?t:t.toJSON())):[this.type,...h(this,O).map((t=>t.toJSON()))];return this.isStart()&&!this.type&&t.unshift([]),this.isEnd()&&(this===h(this,_)||h(h(this,_),q)&&"!"===h(this,A)?.type)&&t.push({}),t}isStart(){if(h(this,_)===this)return!0;if(!h(this,A)?.isStart())return!1;if(0===h(this,D))return!0;let t=h(this,A);for(let e=0;e<h(this,D);e++){let s=h(t,O)[e];if(!(s instanceof St&&"!"===s.type))return!1}return!0}isEnd(){if(h(this,_)===this||"!"===h(this,A)?.type)return!0;if(!h(this,A)?.isEnd())return!1;if(!this.type)return h(this,A)?.isEnd();let t=h(this,A)?h(h(this,A),O).length:0;return h(this,D)===t-1}copyIn(t){"string"==typeof t?this.push(t):this.push(t.clone(this))}clone(t){let e=new St(this.type,t);for(let t of h(this,O))e.copyIn(t);return e}static fromGlob(t,e={}){var s;let l=new St(null,void 0,e);return u(s=St,nt,rt).call(s,t,l,0,e),l}toMMPattern(){if(this!==h(this,_))return h(this,_).toMMPattern();let t=this.toString(),[e,s,l,i]=this.toRegExpSource();if(!(l||h(this,P)||h(this,tt).nocase&&!h(this,tt).nocaseMagicOnly&&t.toUpperCase()!==t.toLowerCase()))return s;let n=(h(this,tt).nocase?"i":"")+(i?"u":"");return Object.assign(new RegExp(`^${e}$`,n),{_src:e,_glob:t})}toRegExpSource(t){let e=t??!!h(this,tt).dot;if(h(this,_)===this&&u(this,lt,it).call(this),!this.type){let s=this.isStart()&&this.isEnd(),l=h(this,O).map((e=>{var l;let[i,n,r,a]="string"==typeof e?u(l=St,ht,ct).call(l,e,h(this,P),s):e.toRegExpSource(t);return o(this,P,h(this,P)||r),o(this,j,h(this,j)||a),i})).join(""),i="";if(this.isStart()&&"string"==typeof h(this,O)[0]&&(1!==h(this,O).length||!Rt.has(h(this,O)[0]))){let s=xt,n=e&&s.has(l.charAt(0))||l.startsWith("\\.")&&s.has(l.charAt(2))||l.startsWith("\\.\\.")&&s.has(l.charAt(4)),r=!e&&!t&&s.has(l.charAt(0));i=n?"(?!(?:^|/)\\.\\.?(?:$|/))":r?wt:""}let n="";return this.isEnd()&&h(h(this,_),q)&&"!"===h(this,A)?.type&&(n="(?:$|\\/)"),[i+l+n,Vt(l),o(this,P,!!h(this,P)),h(this,j)]}let s="*"===this.type||"+"===this.type,l="!"===this.type?"(?:(?!(?:":"(?:",i=u(this,at,dt).call(this,e);if(this.isStart()&&this.isEnd()&&!i&&"!"!==this.type){let t=this.toString();return o(this,O,[t]),this.type=null,o(this,P,void 0),[t,Vt(this.toString()),!1,!1]}let n=!s||t||e?"":u(this,at,dt).call(this,!0);n===i&&(n=""),n&&(i=`(?:${i})(?:${n})*?`);let r="";return r="!"===this.type&&h(this,st)?(this.isStart()&&!e?wt:"")+Yt:l+i+("!"===this.type?"))"+(!this.isStart()||e||t?"":wt)+zt+")":"@"===this.type?")":"?"===this.type?")?":"+"===this.type&&n?")":"*"===this.type&&n?")?":`)${this.type}`),[r,Vt(i),o(this,P,!!h(this,P)),h(this,j)]}},Kt=St;_=new WeakMap,P=new WeakMap,j=new WeakMap,O=new WeakMap,A=new WeakMap,D=new WeakMap,$=new WeakMap,q=new WeakMap,tt=new WeakMap,et=new WeakMap,st=new WeakMap,lt=new WeakSet,it=function(){if(this!==h(this,_))throw new Error("should only call on root");if(h(this,q))return this;let t;for(this.toString(),o(this,q,!0);t=h(this,$).pop();){if("!"!==t.type)continue;let e=t,s=h(e,A);for(;s;){for(let l=h(e,D)+1;!s.type&&l<h(s,O).length;l++)for(let e of h(t,O)){if("string"==typeof e)throw new Error("string part in extglob AST??");e.copyIn(h(s,O)[l])}e=s,s=h(e,A)}}return this},nt=new WeakSet,rt=function(t,e,s,l){var i,n;let r=!1,a=!1,d=-1,c=!1;if(null===e.type){let n=s,h="";for(;n<t.length;){let s=t.charAt(n++);if(r||"\\"===s)r=!r,h+=s;else if(a)n===d+1?("^"===s||"!"===s)&&(c=!0):"]"===s&&!(n===d+2&&c)&&(a=!1),h+=s;else if("["!==s)if(l.noext||!gt(s)||"("!==t.charAt(n))h+=s;else{e.push(h),h="";let r=new St(s,e);n=u(i=St,nt,rt).call(i,t,r,n,l),e.push(r)}else a=!0,d=n,c=!1,h+=s}return e.push(h),n}let m=s+1,p=new St(null,e),b=[],Z="";for(;m<t.length;){let s=t.charAt(m++);if(r||"\\"===s)r=!r,Z+=s;else if(a)m===d+1?("^"===s||"!"===s)&&(c=!0):"]"===s&&!(m===d+2&&c)&&(a=!1),Z+=s;else if("["!==s)if(gt(s)&&"("===t.charAt(m)){p.push(Z),Z="";let e=new St(s,p);p.push(e),m=u(n=St,nt,rt).call(n,t,e,m,l)}else if("|"!==s){if(")"===s)return""===Z&&0===h(e,O).length&&o(e,st,!0),p.push(Z),Z="",e.push(...b,p),m;Z+=s}else p.push(Z),Z="",b.push(p),p=new St(null,e);else a=!0,d=m,c=!1,Z+=s}return e.type=null,o(e,P,void 0),o(e,O,[t.substring(s-1)]),m},at=new WeakSet,dt=function(t){return h(this,O).map((e=>{if("string"==typeof e)throw new Error("string type in extglob ast??");let[s,l,i,n]=e.toRegExpSource(t);return o(this,j,h(this,j)||n),s})).filter((t=>!(this.isStart()&&this.isEnd()&&!t))).join("|")},ht=new WeakSet,ct=function(t,e,s=!1){let l=!1,i="",n=!1;for(let r=0;r<t.length;r++){let a=t.charAt(r);if(l)l=!1,i+=(Lt.has(a)?"\\":"")+a;else if("\\"!==a){if("["===a){let[s,l,a,d]=Gt(t,r);if(a){i+=s,n=n||l,r+=a-1,e=e||d;continue}}"*"!==a?"?"!==a?i+=It(a):(i+=Ht,e=!0):(i+=s&&"*"===t?Yt:zt,e=!0)}else r===t.length-1?i+="\\\\":l=!0}return[i,Vt(t),!!e,n]},c(Kt,nt),c(Kt,ht);var kt=(t,e,s={})=>(bt(e),!(!s.nocomment&&"#"===e.charAt(0))&&new re(e,s).match(t)),Jt=/^\*+([^+@!?\*\[\(]*)$/,Ft=t=>e=>!e.startsWith(".")&&e.endsWith(t),Ct=t=>e=>e.endsWith(t),Nt=t=>(t=t.toLowerCase(),e=>!e.startsWith(".")&&e.toLowerCase().endsWith(t)),Bt=t=>(t=t.toLowerCase(),e=>e.toLowerCase().endsWith(t)),Mt=/^\*+\.\*+$/,vt=t=>!t.startsWith(".")&&t.includes("."),Tt=t=>"."!==t&&".."!==t&&t.includes("."),Qt=/^\.\*+$/,Ut=t=>"."!==t&&".."!==t&&t.startsWith("."),Et=/^\*+$/,_t=t=>0!==t.length&&!t.startsWith("."),Pt=t=>0!==t.length&&"."!==t&&".."!==t,jt=/^\?+([^+@!?\*\[\(]*)?$/,Ot=([t,e=""])=>{let s=qt([t]);return e?(e=e.toLowerCase(),t=>s(t)&&t.toLowerCase().endsWith(e)):s},At=([t,e=""])=>{let s=te([t]);return e?(e=e.toLowerCase(),t=>s(t)&&t.toLowerCase().endsWith(e)):s},Dt=([t,e=""])=>{let s=te([t]);return e?t=>s(t)&&t.endsWith(e):s},$t=([t,e=""])=>{let s=qt([t]);return e?t=>s(t)&&t.endsWith(e):s},qt=([t])=>{let e=t.length;return t=>t.length===e&&!t.startsWith(".")},te=([t])=>{let e=t.length;return t=>t.length===e&&"."!==t&&".."!==t},ee="object"==typeof process&&process?"object"==typeof process.env&&process.env&&process.env.__MINIMATCH_TESTING_PLATFORM__||process.platform:"posix";kt.sep="win32"===ee?"\\":"/";var se=Symbol("globstar **");kt.GLOBSTAR=se,kt.filter=(t,e={})=>s=>kt(s,t,e);var le=(t,e={})=>Object.assign({},t,e);kt.defaults=t=>{if(!t||"object"!=typeof t||!Object.keys(t).length)return kt;let e=kt;return Object.assign(((s,l,i={})=>e(s,l,le(t,i))),{Minimatch:class extends e.Minimatch{constructor(e,s={}){super(e,le(t,s))}static defaults(s){return e.defaults(le(t,s)).Minimatch}},AST:class extends e.AST{constructor(e,s,l={}){super(e,s,le(t,l))}static fromGlob(s,l={}){return e.AST.fromGlob(s,le(t,l))}},unescape:(s,l={})=>e.unescape(s,le(t,l)),escape:(s,l={})=>e.escape(s,le(t,l)),filter:(s,l={})=>e.filter(s,le(t,l)),defaults:s=>e.defaults(le(t,s)),makeRe:(s,l={})=>e.makeRe(s,le(t,l)),braceExpand:(s,l={})=>e.braceExpand(s,le(t,l)),match:(s,l,i={})=>e.match(s,l,le(t,i)),sep:e.sep,GLOBSTAR:se})};var ie=(t,e={})=>(bt(t),e.nobrace||!/\{(?:(?!\{).)*\}/.test(t)?[t]:(0,pt.default)(t));kt.braceExpand=ie,kt.makeRe=(t,e={})=>new re(t,e).makeRe(),kt.match=(t,e,s={})=>{let l=new re(e,s);return t=t.filter((t=>l.match(t))),l.options.nonull&&!t.length&&t.push(e),t};var ne=/[?*]|[+@!]\(.*?\)|\[|\]/,re=class{options;set;pattern;windowsPathsNoEscape;nonegate;negate;comment;empty;preserveMultipleSlashes;partial;globSet;globParts;nocase;isWindows;platform;windowsNoMagicRoot;regexp;constructor(t,e={}){bt(t),e=e||{},this.options=e,this.pattern=t,this.platform=e.platform||ee,this.isWindows="win32"===this.platform,this.windowsPathsNoEscape=!!e.windowsPathsNoEscape||!1===e.allowWindowsEscape,this.windowsPathsNoEscape&&(this.pattern=this.pattern.replace(/\\/g,"/")),this.preserveMultipleSlashes=!!e.preserveMultipleSlashes,this.regexp=null,this.negate=!1,this.nonegate=!!e.nonegate,this.comment=!1,this.empty=!1,this.partial=!!e.partial,this.nocase=!!this.options.nocase,this.windowsNoMagicRoot=void 0!==e.windowsNoMagicRoot?e.windowsNoMagicRoot:!(!this.isWindows||!this.nocase),this.globSet=[],this.globParts=[],this.set=[],this.make()}hasMagic(){if(this.options.magicalBraces&&this.set.length>1)return!0;for(let t of this.set)for(let e of t)if("string"!=typeof e)return!0;return!1}debug(...t){}make(){let t=this.pattern,e=this.options;if(!e.nocomment&&"#"===t.charAt(0))return void(this.comment=!0);if(!t)return void(this.empty=!0);this.parseNegate(),this.globSet=[...new Set(this.braceExpand())],e.debug&&(this.debug=(...t)=>console.error(...t)),this.debug(this.pattern,this.globSet);let s=this.globSet.map((t=>this.slashSplit(t)));this.globParts=this.preprocess(s),this.debug(this.pattern,this.globParts);let l=this.globParts.map(((t,e,s)=>{if(this.isWindows&&this.windowsNoMagicRoot){let e=!(""!==t[0]||""!==t[1]||"?"!==t[2]&&ne.test(t[2])||ne.test(t[3])),s=/^[a-z]:/i.test(t[0]);if(e)return[...t.slice(0,4),...t.slice(4).map((t=>this.parse(t)))];if(s)return[t[0],...t.slice(1).map((t=>this.parse(t)))]}return t.map((t=>this.parse(t)))}));if(this.debug(this.pattern,l),this.set=l.filter((t=>-1===t.indexOf(!1))),this.isWindows)for(let t=0;t<this.set.length;t++){let e=this.set[t];""===e[0]&&""===e[1]&&"?"===this.globParts[t][2]&&"string"==typeof e[3]&&/^[a-z]:$/i.test(e[3])&&(e[2]="?")}this.debug(this.pattern,this.set)}preprocess(t){if(this.options.noglobstar)for(let e=0;e<t.length;e++)for(let s=0;s<t[e].length;s++)"**"===t[e][s]&&(t[e][s]="*");let{optimizationLevel:e=1}=this.options;return e>=2?(t=this.firstPhasePreProcess(t),t=this.secondPhasePreProcess(t)):t=e>=1?this.levelOneOptimize(t):this.adjascentGlobstarOptimize(t),t}adjascentGlobstarOptimize(t){return t.map((t=>{let e=-1;for(;-1!==(e=t.indexOf("**",e+1));){let s=e;for(;"**"===t[s+1];)s++;s!==e&&t.splice(e,s-e)}return t}))}levelOneOptimize(t){return t.map((t=>0===(t=t.reduce(((t,e)=>{let s=t[t.length-1];return"**"===e&&"**"===s?t:".."===e&&s&&".."!==s&&"."!==s&&"**"!==s?(t.pop(),t):(t.push(e),t)}),[])).length?[""]:t))}levelTwoFileOptimize(t){Array.isArray(t)||(t=this.slashSplit(t));let e=!1;do{if(e=!1,!this.preserveMultipleSlashes){for(let s=1;s<t.length-1;s++){let l=t[s];1===s&&""===l&&""===t[0]||("."===l||""===l)&&(e=!0,t.splice(s,1),s--)}"."===t[0]&&2===t.length&&("."===t[1]||""===t[1])&&(e=!0,t.pop())}let s=0;for(;-1!==(s=t.indexOf("..",s+1));){let l=t[s-1];l&&"."!==l&&".."!==l&&"**"!==l&&(e=!0,t.splice(s-1,2),s-=2)}}while(e);return 0===t.length?[""]:t}firstPhasePreProcess(t){let e=!1;do{e=!1;for(let s of t){let l=-1;for(;-1!==(l=s.indexOf("**",l+1));){let i=l;for(;"**"===s[i+1];)i++;i>l&&s.splice(l+1,i-l);let n=s[l+1],r=s[l+2],a=s[l+3];if(".."!==n||!r||"."===r||".."===r||!a||"."===a||".."===a)continue;e=!0,s.splice(l,1);let d=s.slice(0);d[l]="**",t.push(d),l--}if(!this.preserveMultipleSlashes){for(let t=1;t<s.length-1;t++){let l=s[t];1===t&&""===l&&""===s[0]||("."===l||""===l)&&(e=!0,s.splice(t,1),t--)}"."===s[0]&&2===s.length&&("."===s[1]||""===s[1])&&(e=!0,s.pop())}let i=0;for(;-1!==(i=s.indexOf("..",i+1));){let t=s[i-1];if(t&&"."!==t&&".."!==t&&"**"!==t){e=!0;let t=1===i&&"**"===s[i+1]?["."]:[];s.splice(i-1,2,...t),0===s.length&&s.push(""),i-=2}}}}while(e);return t}secondPhasePreProcess(t){for(let e=0;e<t.length-1;e++)for(let s=e+1;s<t.length;s++){let l=this.partsMatch(t[e],t[s],!this.preserveMultipleSlashes);!l||(t[e]=l,t[s]=[])}return t.filter((t=>t.length))}partsMatch(t,e,s=!1){let l=0,i=0,n=[],r="";for(;l<t.length&&i<e.length;)if(t[l]===e[i])n.push("b"===r?e[i]:t[l]),l++,i++;else if(s&&"**"===t[l]&&e[i]===t[l+1])n.push(t[l]),l++;else if(s&&"**"===e[i]&&t[l]===e[i+1])n.push(e[i]),i++;else if("*"!==t[l]||!e[i]||!this.options.dot&&e[i].startsWith(".")||"**"===e[i]){if("*"!==e[i]||!t[l]||!this.options.dot&&t[l].startsWith(".")||"**"===t[l])return!1;if("a"===r)return!1;r="b",n.push(e[i]),l++,i++}else{if("b"===r)return!1;r="a",n.push(t[l]),l++,i++}return t.length===e.length&&n}parseNegate(){if(this.nonegate)return;let t=this.pattern,e=!1,s=0;for(let l=0;l<t.length&&"!"===t.charAt(l);l++)e=!e,s++;s&&(this.pattern=t.slice(s)),this.negate=e}matchOne(t,e,s=!1){let l=this.options;if(this.isWindows){let s="string"==typeof t[0]&&/^[a-z]:$/i.test(t[0]),l=!s&&""===t[0]&&""===t[1]&&"?"===t[2]&&/^[a-z]:$/i.test(t[3]),i="string"==typeof e[0]&&/^[a-z]:$/i.test(e[0]),n=l?3:s?0:void 0,r=!i&&""===e[0]&&""===e[1]&&"?"===e[2]&&"string"==typeof e[3]&&/^[a-z]:$/i.test(e[3])?3:i?0:void 0;if("number"==typeof n&&"number"==typeof r){let[s,l]=[t[n],e[r]];s.toLowerCase()===l.toLowerCase()&&(e[r]=s,r>n?e=e.slice(r):n>r&&(t=t.slice(n)))}}let{optimizationLevel:i=1}=this.options;i>=2&&(t=this.levelTwoFileOptimize(t)),this.debug("matchOne",this,{file:t,pattern:e}),this.debug("matchOne",t.length,e.length);for(var n=0,r=0,a=t.length,d=e.length;n<a&&r<d;n++,r++){this.debug("matchOne loop");var h=e[r],c=t[n];if(this.debug(e,h,c),!1===h)return!1;if(h===se){this.debug("GLOBSTAR",[e,h,c]);var o=n,u=r+1;if(u===d){for(this.debug("** at the end");n<a;n++)if("."===t[n]||".."===t[n]||!l.dot&&"."===t[n].charAt(0))return!1;return!0}for(;o<a;){var m=t[o];if(this.debug("\nglobstar while",t,o,e,u,m),this.matchOne(t.slice(o),e.slice(u),s))return this.debug("globstar found match!",o,a,m),!0;if("."===m||".."===m||!l.dot&&"."===m.charAt(0)){this.debug("dot detected!",t,o,e,u);break}this.debug("globstar swallow a segment, and continue"),o++}return!(!s||(this.debug("\n>>> no match, partial?",t,o,e,u),o!==a))}let i;if("string"==typeof h?(i=c===h,this.debug("string match",h,c,i)):(i=h.test(c),this.debug("pattern match",h,c,i)),!i)return!1}if(n===a&&r===d)return!0;if(n===a)return s;if(r===d)return n===a-1&&""===t[n];throw new Error("wtf?")}braceExpand(){return ie(this.pattern,this.options)}parse(t){bt(t);let e=this.options;if("**"===t)return se;if(""===t)return"";let s,l=null;(s=t.match(Et))?l=e.dot?Pt:_t:(s=t.match(Jt))?l=(e.nocase?e.dot?Bt:Nt:e.dot?Ct:Ft)(s[1]):(s=t.match(jt))?l=(e.nocase?e.dot?At:Ot:e.dot?Dt:$t)(s):(s=t.match(Mt))?l=e.dot?Tt:vt:(s=t.match(Qt))&&(l=Ut);let i=Kt.fromGlob(t,this.options).toMMPattern();return l?Object.assign(i,{test:l}):i}makeRe(){if(this.regexp||!1===this.regexp)return this.regexp;let t=this.set;if(!t.length)return this.regexp=!1,this.regexp;let e=this.options,s=e.noglobstar?"[^/]*?":e.dot?"(?:(?!(?:\\/|^)(?:\\.{1,2})($|\\/)).)*?":"(?:(?!(?:\\/|^)\\.).)*?",l=new Set(e.nocase?["i"]:[]),i=t.map((t=>{let e=t.map((t=>{if(t instanceof RegExp)for(let e of t.flags.split(""))l.add(e);return"string"==typeof t?(t=>t.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&"))(t):t===se?se:t._src}));return e.forEach(((t,l)=>{let i=e[l+1],n=e[l-1];t!==se||n===se||(void 0===n?void 0!==i&&i!==se?e[l+1]="(?:\\/|"+s+"\\/)?"+i:e[l]=s:void 0===i?e[l-1]=n+"(?:\\/|"+s+")?":i!==se&&(e[l-1]=n+"(?:\\/|\\/"+s+"\\/)"+i,e[l+1]=se))})),e.filter((t=>t!==se)).join("/")})).join("|"),[n,r]=t.length>1?["(?:",")"]:["",""];i="^"+n+i+r+"$",this.negate&&(i="^(?!"+i+").+$");try{this.regexp=new RegExp(i,[...l].join(""))}catch{this.regexp=!1}return this.regexp}slashSplit(t){return this.preserveMultipleSlashes?t.split("/"):this.isWindows&&/^\/\/[^\/]+/.test(t)?["",...t.split(/\/+/)]:t.split(/\/+/)}match(t,e=this.partial){if(this.debug("match",t,this.pattern),this.comment)return!1;if(this.empty)return""===t;if("/"===t&&e)return!0;let s=this.options;this.isWindows&&(t=t.split("\\").join("/"));let l=this.slashSplit(t);this.debug(this.pattern,"split",l);let i=this.set;this.debug(this.pattern,"set",i);let n=l[l.length-1];if(!n)for(let t=l.length-2;!n&&t>=0;t--)n=l[t];for(let t=0;t<i.length;t++){let r=i[t],a=l;if(s.matchBase&&1===r.length&&(a=[n]),this.matchOne(a,r,e))return!!s.flipNegate||!this.negate}return!s.flipNegate&&this.negate}static defaults(t){return kt.defaults(t).Minimatch}};kt.AST=Kt,kt.Minimatch=re,kt.escape=(t,{windowsPathsNoEscape:e=!1}={})=>e?t.replace(/[?*()[\]]/g,"[$&]"):t.replace(/[?*()[\]\\]/g,"\\$&"),kt.unescape=Vt;var ae=Atomics.waitAsync||(()=>{let t=new Blob(["onmessage = ev => {\n    const [b, i, v] = ev.data\n    const f = new Int32Array(b)\n    postMessage(Atomics.wait(f, i, v));\n  }"],{type:"text/javascript"}),e=URL.createObjectURL(t),s=new mt(e);return(t,e,l)=>{let i=new Promise((t=>{s.once("message",(e=>{t(e)}))}));return s.postMessage([t.buffer,e,l]),{async:!0,value:i}}})(),de=class{worker;sharedData;sharedDataView;hostFlag;opts;#t;#e=null;constructor(t,e,s,l){this.worker=t,this.sharedData=e,this.sharedDataView=new DataView(e),this.hostFlag=new Int32Array(e),this.opts=s,this.#t=l,this.hostFlag[0]=ue.SAB_BASE_OFFSET,this.worker.on("message",(t=>this.#s(t)))}async reset(){return!this.isActive()&&(await this.#n("reset"),this.#t[z](),!0)}isActive(){return Boolean(this.#e)}async#s(t){switch(t?.type){case"invoke":return this.#r(t);case"return":return this.#i(t);case"log":return this.#l(t)}}#l(t){let e=this.opts.logger[t.level];"function"!=typeof e?this.opts.logger?.error(`failed to find loglevel="${t.level}" on logger: message=${t.message}`):e.call(this.opts.logger,t.message)}#i(t){let e=this.#e||null;if(null===e)throw new Error('received "return" call with no corresponding request');this.#e=null;let[s,l]=e;if(!Array.isArray(t.results)||2!==t.results.length)return l(new Error('received malformed "return"'));let[i,n]=t.results;i?l(i):s(n)}async#n(t,...e){if(this.#e)throw new Error("plugin is not reentrant");let s,l,i=new Promise(((t,e)=>{s=t,l=e}));return this.#e=[s,l],this.worker.postMessage({type:"invoke",handler:t,args:e}),i}async functionExists(t){return await this.#n("functionExists",t)}async call(t,e){let s=this.#t[H](e),[l,i]=await this.callBlock(t,s),n=null!==l,r=l??i;if(null===r)return null;let a=this.#t[R](r);if(null===a)return null;let d=new W(b.allowSharedBufferCodec?a.buffer:new Uint8Array(a.buffer).slice().buffer);if(n){let t=(new TextDecoder).decode(d);throw new Error(`Plugin-originated error: ${t}`)}return d}async callBlock(t,e){let s=this.#t[I](),{results:l,state:i}=await this.#n("call",t,e,s);this.#t[L](i,!0);let[n,r]=l;if(n)throw n;return r}async#r(t){let e=new ue(this.sharedData),s=(this.opts.functions[t.namespace]??{})[t.func];try{if(!s)throw Error(`Plugin error: host function "${t.namespace}" "${t.func}" does not exist`);this.#t[L](t.state,!0);let l,i=await s(this.#t,...t.args),{blocks:n}=this.#t[I]();for(let[t,s]of n)l=e.writeUint8(4),l&&await l,l=e.writeUint32(s),l&&await l,l=e.writeUint32(t?.byteLength||0),l&&await l,t&&(l=e.write(t),l&&await l);"bigint"==typeof i?(l=e.writeUint8(1),l&&await l,l=e.writeUint64(i),l&&await l):"number"==typeof i?(l=e.writeUint8(2),l&&await l,l=e.writeFloat64(i),l&&await l):(l=e.writeUint8(3),l&&await l),l=e.writeUint8(0),l&&await l,await e.flush()}catch(t){this.close();let[,e]=this.#e;return this.#e=null,e(t)}}async getExports(t){return await this.#n("getExports",t??"0")}async getImports(t){return await this.#n("getImports",t??"0")}async getInstance(){throw new Error("todo")}async close(){this.worker&&(this.worker.terminate(),this.worker=null)}},he=class{fetch;lastStatusCode;allowedHosts;constructor(t,e){this.fetch=t,this.allowedHosts=e,this.lastStatusCode=0}contribute(t){t[v]??={},t[v].http_request=(t,e,s)=>this.makeRequest(t,e,s),t[v].http_status_code=()=>this.lastStatusCode}async makeRequest(t,e,s){let l=t.read(e);if(null===l)return 0n;let{header:i,url:n,method:r}=l.json(),a=r??"GET",d=new URL(n);if(!this.allowedHosts.some((t=>t===d.hostname||function(t,e){return kt(t,e)}(d.hostname,t))))throw new Error(`Call error: HTTP request to "${d}" is not allowed (no allowedHosts match "${d.hostname}")`);let h=0n===s||"GET"===a||"HEAD"===a?null:t.read(s)?.bytes(),c=this.fetch,o=await c(n,{headers:i,method:a,...h?{body:h.slice()}:{}});return this.lastStatusCode=o.status,t.store(new Uint8Array(await o.arrayBuffer()))}};async function ce(t,e,s){let l=new mt(ot),i=new S(SharedArrayBuffer,t.logger,t.config);new he(t.fetch,t.allowedHosts).contribute(t.functions),await new Promise(((t,e)=>{l.on("message",(function s(i){"initialized"!==i?.type&&e(new Error(`received unexpected message (type=${i?.type})`)),l.removeListener("message",s),t(null)}))}));let n=new SharedArrayBuffer(t.sharedArrayBufferSize),{fetch:r,logger:a,...d}=t,h={...d,type:"init",functions:Object.fromEntries(Object.entries(t.functions||{}).map((([t,e])=>[t,Object.keys(e)]))),names:e,modules:s,sharedData:n},c=new Promise(((t,e)=>{l.on("message",(function s(i){"ready"!==i?.type&&e(new Error(`received unexpected message (type=${i?.type})`)),l.removeListener("message",s),t(null)}))}));return l.postMessage(h),await c,new de(l,n,t,i)}var oe=class{output;scratch;scratchView;outputOffset;flag;constructor(t){this.scratch=new ArrayBuffer(8),this.scratchView=new DataView(this.scratch),this.output=t,this.outputOffset=oe.SAB_BASE_OFFSET,this.flag=new Int32Array(this.output)}async flush(){if(this.outputOffset===oe.SAB_BASE_OFFSET)return;let t=this.outputOffset;for(this.outputOffset=oe.SAB_BASE_OFFSET;Atomics.compareExchange(this.flag,oe.SAB_IDX,oe.SAB_BASE_OFFSET,t)!==t;);Atomics.notify(this.flag,oe.SAB_IDX,1);let e,s=ae(this.flag,oe.SAB_IDX,t,5e3);try{e=setInterval((()=>{}),0),s.async&&(s.value=await s.value)}finally{clearInterval(e)}if("timed-out"===s.value)throw new Error(`encountered timeout while flushing host function to worker memory ${this.flag[0]}`)}async spanningWrite(t){let e=0,s=this.output.byteLength-this.outputOffset,l=1+Math.floor((t.byteLength-s)/(this.output.byteLength-oe.SAB_BASE_OFFSET)),i=(t.byteLength-s)%(this.output.byteLength-oe.SAB_BASE_OFFSET);do{new Uint8Array(this.output).set(t.subarray(e,e+s),this.outputOffset),this.outputOffset+=s,e+=s,await this.flush(),s=this.output.byteLength-oe.SAB_BASE_OFFSET,--l}while(0!=l);i&&this.write(t.subarray(e,e+i))}write(t){return t.byteLength+this.outputOffset<this.output.byteLength?(new Uint8Array(this.output).set(new Uint8Array(t),this.outputOffset),void(this.outputOffset+=t.byteLength)):this.spanningWrite(new Uint8Array(t))}writeUint8(t){return this.scratchView.setUint8(0,t),this.write(this.scratch.slice(0,1))}writeUint32(t){return this.scratchView.setUint32(0,t,!0),this.write(this.scratch.slice(0,4))}writeUint64(t){return this.scratchView.setBigUint64(0,t,!0),this.write(this.scratch.slice(0,8))}writeFloat64(t){return this.scratchView.setFloat64(0,t,!0),this.write(this.scratch.slice(0,8))}},ue=oe;async function me(t,e={}){if(e={...e},e.useWasi??=!1,e.functions=e.functions||{},e.allowedPaths??={},e.allowedHosts??=[].concat(e.allowedHosts||[]),e.logger??=console,e.config??={},e.fetch??=fetch,e.runInWorker??=b.hasWorkerCapability,e.runInWorker&&!b.hasWorkerCapability)throw new Error("Cannot enable off-thread wasm; current context is not `crossOriginIsolated` (see https://mdn.io/crossOriginIsolated)");let[s,l]=await async function(t,e){let s=[],l=await y(t,e),i=await Promise.all(l.wasm.map((async(t,l)=>{let i,n;if(t.data){let e=t.data;n=e.buffer?e.buffer:e,i=await WebAssembly.compile(e)}else if(t.path){t.path;let e=await async function(t){throw new Error("readFile not supported in this environment")}();n=e.buffer,i=await WebAssembly.compile(e)}else if(t.url){let s=await e(t.url,{headers:{accept:"application/wasm;q=0.9,application/octet-stream;q=0.8","user-agent":"extism"}}),l=await Z(s,Boolean(t.hash));n=l.data,i=l.module}else if(t.response){let e=await Z(t.response,Boolean(t.hash));n=e.data,i=e.module}else{if(!t.module)throw new Error(`Unrecognized wasm item at index ${l}. Keys include: "${Object.keys(t).sort().join(",")}"`);s[l]=t.name??String(l),i=t.module}if(t.hash){if(!n)throw new Error("Item specified a hash but WebAssembly.Module source data is unavailable for hashing");let e=new Uint8Array(await crypto.subtle.digest("SHA-256",n)),s=new Uint8Array(32),l=!0;for(let i=0;i<32;++i)s[i]=parseInt(t.hash.slice(i<<1,2+(i<<1)),16),l=l&&s[i]===e[i];let i=()=>[...e].map((t=>t.toString(16).padStart(2,"0"))).join("");if(!l)throw new Error(`Plugin error: hash mismatch. Expected: ${t.hash}. Actual: ${i()}`);t.name??=i()}return s[l]=t.name??String(l),i})));return[s,i]}(await Promise.resolve(t),e.fetch??fetch),i={allowedHosts:e.allowedHosts,allowedPaths:e.allowedPaths,functions:e.functions,fetch:e.fetch||fetch,wasiEnabled:e.useWasi,logger:e.logger,config:e.config,sharedArrayBufferSize:Number(e.sharedArrayBufferSize)||65536};return(e.runInWorker?ce:Q)(i,s,l)}a(ue,"SAB_IDX",0),a(ue,"SAB_BASE_OFFSET",4),onmessage=async t=>{let e="golang"===t.data?"go":"rust";const s=await me("http://localhost:8080/wasm/"+e);if(await s.functionExists("render")){let e=(await s.call("render",t.data)).text();e.startsWith("`")&&(e=e.slice(1)),e.endsWith("`")&&(e=e.slice(0,-1)),postMessage(e),await s.close()}else await s.close()}})();